<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>西郊书院 &#8211; OnceMore</title>
<meta name="description" content="Describe this nonsense.">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="西郊书院">
<meta property="og:description" content="Describe this nonsense.">
<meta property="og:url" content="http://localhost:4000/blog/page3/index.html">
<meta property="og:site_name" content="OnceMore">

<meta name="google-site-verification" content="i2ojlx9jpDBBAKREtMe5JMN1DCdIAlO97Qrf4vOuFF4">



<link rel="canonical" href="http://localhost:4000/blog/page3/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="OnceMore Feed">
<link rel="author" href="https://google.com/https://plus.google.com/110411659539252839234?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://localhost:4000/blog">博客</a></li>
		<li><a href="http://localhost:4000">主页</a></li>
		<li><a href="http://localhost:4000/blog/about/">关于博客</a></li>
		<li>
			<a href="#">文章目录</a>
			<ul class="dl-submenu">
				<li><a href="http://localhost:4000/blog/posts/">所有文章</a></li>
				<li><a href="http://localhost:4000/blog/tags/">所有标签</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  
  
    <div class="entry-image">
      <img src="http://localhost:4000/images/abstract-7.jpg" alt="西郊书院">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>西郊书院</h1>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-04-11T00:00:00+08:00"><a href="http://localhost:4000/blog/knr-chap1/">April 11, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About OnceMore">OnceMore</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~49 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/blog/knr-chap1/" rel="bookmark" title="重新修炼C-K&R-Chapter1" itemprop="url">重新修炼C-K&R-Chapter1</a></h1>
    
  </header>
  <div class="entry-content">
    <h1 class="no_toc" id="section">目录</h1>

<ul id="markdown-toc">
  <li><a href="#helloworld">Hello,world!</a></li>
  <li><a href="#section-1">变量和算术表达式</a></li>
  <li><a href="#for">for语句</a></li>
  <li><a href="#section-2">符号常量</a></li>
  <li><a href="#section-3">字符输入/输出</a>    <ul>
      <li><a href="#section-4">文件拷贝</a></li>
      <li><a href="#section-5">字符统计</a></li>
      <li><a href="#section-6">行统计</a></li>
      <li><a href="#section-7">单词统计</a></li>
    </ul>
  </li>
  <li><a href="#section-8">数组</a></li>
  <li><a href="#section-9">函数</a></li>
  <li><a href="#section-10">参数-传值调用</a></li>
  <li><a href="#section-11">字符数组</a></li>
  <li><a href="#section-12">外部变量与作用域</a></li>
</ul>

<h1 id="helloworld">Hello,world!</h1>
<p>C源文件后缀为<code>*.c</code>，如下helloworld.c文件</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello,world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p>使用gcc编译文件，在不指定参数的情况下，会得到<code>a.out</code>可执行文件，在bash下使用<code>./a.out</code>运行程序,能够
得到输出。</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>gcc helloworld.c
<span class="nv">$ </span>./a.out
Hello,world!</code></pre></div>

<p>C源程序在任何条件下都包括<strong>函数(functions)</strong>和<strong>变量(variables)</strong>，函数包括指定计算
操作的<strong>语句(statements)</strong>，变量存储计算期间使用的值。<strong>main函数</strong>比较特殊，程序从
main函数的开头开始执行，这意味着每一个程序都必须在某个地方具有main函数。</p>

<p>main函数通常会<strong>调用(call)</strong>其他函数来执行任务,这些函数可以自己编写，也可以是包
含的<strong>库文件(libraries)</strong>提供的函数，如<code>helloworld.c</code>中的第一行<code>#include &lt;stdio.h&gt;</code>告
诉<strong>编译器(compiler)</strong>需要包含<strong>标准输入/输出库(standard input/output library)</strong>，因为
<code>main</code>函数内用到了该库中的<code>printf()</code>函数。</p>

<p>函数之间进行通讯的一种方法是让函数调用提供一个称为<strong>参数(arguments)</strong>的值列表给被调用
的函数，在<code>helloworld.c</code>中，<code>main</code>函数不接收任何参数，则是一个空参数列表<code>()</code>。</p>

<p>函数的语句被包括在<code>{ }</code>中，<code>helloworld.c</code>只有一条语句，调用了<code>printf()</code>函数，传递的参数
为<code>"Hello,world\n"</code>,<code>printf()</code>是一个<strong>库函数</strong>，将参数输出。上例中传递的是一个<strong>字符串常量</strong>，
<code>\n</code>称为<strong>换行符</strong>，在输出字符串后进行换行。<code>printf()</code>函数不会自动设置换行，所以下面的程序
会得到和<code>helloworld.c</code>一样的输出。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello,&quot;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;world!&quot;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p><code>\n</code>实际上代表一个字符(换行符)，换行符属于不能显式打印或显式可见的符号，C 用<strong>转义字符(escape sequence)</strong>来处理这类字符。
如<code>\t</code>代表制表符，<code>\b</code>表示退格，<code>\"</code>表示双引号，<code>\\</code>表示反斜杠。</p>

<blockquote>
  <p>Exercise 1-1.Run the “hello, world” program on your system. Experiment with leaving out parts of the 
program, to see what error messages you get.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;hello, world</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">return0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p>这个程序中加入了<code>return</code>语句，因为<code>main</code>函数总是返回<code>int</code>型变量，显式地指出是一种比较好的编码风格。</p>
</blockquote>

<blockquote>
  <p>exercise 1-2.experiment to find out what happens when printf’s argument string contains \c, where c 
is some character not listed above.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;响铃警告. </span><span class="se">\a\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;换页. </span><span class="se">\f\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;这个转义字符, </span><span class="se">\r</span><span class="s">, 将光标移向行首.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">水平制表符.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;垂直制表符</span><span class="se">\v</span><span class="s">换行并缩进到上一行行尾后一个字符.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;回格&lt;&gt;.</span><span class="se">\b\b</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%c&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">c</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p>注意有一些转义字符会在不同的终端下产生不同的效果(如<code>\v</code>)。</p>
</blockquote>

<h1 id="section-1">变量和算术表达式</h1>
<p>温度转换程序<script type="math/tex">^{\circ}C=(5/9)(^{\circ}F-32)</script></p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cm">/* print Fahrenheit-Celsius table</span>
<span class="cm">	for fahr = 0,20,...300 */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">fahr</span><span class="p">,</span><span class="n">celsius</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">step</span><span class="p">;</span>

	<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* lower limit of temperature scale */</span>
	<span class="n">upper</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>	<span class="cm">/* upper limit */</span>
	<span class="n">step</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>	<span class="cm">/* step size */</span>

	<span class="n">fahr</span> <span class="o">=</span> <span class="n">lower</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">fahr</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">celsius</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="n">fahr</span> <span class="o">-</span><span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="mi">9</span><span class="p">;</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\t</span><span class="s">%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fahr</span><span class="p">,</span> <span class="n">celsius</span><span class="p">);</span>
		<span class="n">fahr</span> <span class="o">=</span> <span class="n">fahr</span> <span class="o">+</span> <span class="n">step</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p><code>/* */</code>之间的内容称为<strong>注释(comment)</strong>，其间的任何内容都会被编译器排除。</p>

<p>C中的变量在使用之前必须被<strong>声明(declaration)</strong>，说明变量的性质，通常包括变量类型和变量列表。
<code>int</code>类型表示整型。C还提供了其他数据类型，如<code>float</code>(浮点型)，<code>char</code>(字符型)，<code>short</code>(短整型)，
<code>long</code>(长整型)，<code>double</code>(双精度浮点型)等。这些类型的大小是<strong>依赖于机器(machine-dependent)</strong>的。</p>

<p><code>=</code>表示<strong>赋值运算(assignment statements)</strong>。</p>

<p>温度表的每一行的操作方式是相同的，这种情况下可以采用<strong>循环(loop)</strong>来处理，上例中采用了<code>while</code>循环。
其操作流程为：</p>

<ol>
  <li>测试括号内条件</li>
  <li>如果括号内条件为真，循环体(<code>{ }</code>内的语句)被执行，然后继续测试括号内条件，循环<code>1.</code>和<code>2.</code></li>
  <li>如果括号内条件为假，则循环终止</li>
</ol>

<p>将循环语句用<code>{ }</code>括起来，同时对语句采用<strong>缩进(indent)</strong>是比较好的编码风格。<strong>K&amp;R</strong>建议:</p>

<blockquote>
  <p>writing only one statement per line, and using blanks around operators to clarify grouping. </p>
</blockquote>

<p>注意到<code>celsius = 5 * (fahr - 32) / 9;</code>中先乘5再除以9而不是直接乘以5/9，因为C的整型除法会截断小数
部分，因为5和9都是整数，5/9得到的结果将是0，这样会造成整个温度表转换出来的都是0。</p>

<p>上例的<code>printf()</code>函数用到了格式化输出，<code>%d</code>表示十进制(decimal)整型，变量在字符串参数之后按次序列出，用<code>,</code>分隔。
例子那样使用<code>printf()</code>表示输出<code>fahr</code>和<code>celsius</code>变量，中间用一个制表符<code>\t</code>隔开。注意<code>%</code>和后面的变量列表元素数
量以及对应元素的类型必须匹配。</p>

<p>需要注意，<code>printf()</code>并不是C语言的一部分，并且C语言中没有定义输入和输出，<code>printf()</code>属于标准库函数。</p>

<p>上例的输出并不是很美观，因为没有右对齐，解决这个问题的方法是对<code>%d</code>指定一个宽度，
比如<code>printf("%3d %6d\n",fahr,celsius);</code>，这样会将<code>fahr</code>用3个字符宽度输出，<code>celsius</code>用6个字符宽度输出。</p>

<p>另外，由于整型除法截断，上例并不是很精确，使用<strong>浮点型</strong>来进行运算可以解决这个问题。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cm">/* print Fahrenheit-Celsius table</span>
<span class="cm">for fahr = 0, 20, ..., 300; floating-point version */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">float</span> <span class="n">fahr</span><span class="p">,</span> <span class="n">celsius</span><span class="p">;</span>
	<span class="kt">float</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">step</span><span class="p">;</span>
	
	<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* lower limit of temperatuire scale */</span>
	<span class="n">upper</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>	<span class="cm">/* upper limit */</span>
	<span class="n">step</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>	<span class="cm">/* step size */</span>

	<span class="n">fahr</span> <span class="o">=</span> <span class="n">lower</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">fahr</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">celsius</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">fahr</span><span class="o">-</span><span class="mf">32.0</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3.0f %6.1f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fahr</span><span class="p">,</span> <span class="n">celsius</span><span class="p">);</span>
		<span class="n">fahr</span> <span class="o">=</span> <span class="n">fahr</span> <span class="o">+</span> <span class="n">step</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>将<code>fahr</code>和<code>celsius</code>改成<strong>float</strong>类型后，温度转换能以更自然的形式写出。<code>5.0</code>和<code>9.0</code>表示这两个
常量是浮点型，则<code>5.0/9.0</code>不会产生截断。如果<strong>操作数</strong>都是浮点型，则按照浮点型运算(如上例)，
如果操作数既有整型也有浮点型，则整型会在运算之前转换成浮点型。<strong>K&amp;R</strong>建议：</p>

<blockquote>
  <p>writing float-point constants with explicit decimal points even when they have integral 
  values emphasizes their floating-point nature for human readers. </p>
</blockquote>

<p><code>printf()</code>中的<code>%3.0f</code>表示浮点数<code>fahr</code>用至少3个字符的宽度打印，并且不带小数点和小数部分，<code>%6.1f</code>
表示浮点数<code>celsius</code>用至少6个字符的宽度打印，在小数点后带1位小数。注意指定浮点数格式的两个部分可以省去，
如<code>%6f</code>只指定宽度，<code>%,2f</code>只指定小数点后保留两位小数，而宽度不受限制，<code>%f</code>只指定输出浮点数。</p>

<p>同时，<code>printf()</code>还能识别的格式化参数有<code>%o</code>(八进制整数)，<code>%x</code>(十六进制整数)，<code>%c</code>(字符)，<code>%s</code>(字符串)
以及<code>%%</code>(不转换格式，输出一个”%”)</p>

<blockquote>
  <p>Exercise 1-3. Modify the temperature conversion program to print a heading above the table.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">float</span> <span class="n">fahr</span><span class="p">,</span><span class="n">celsius</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">step</span><span class="p">;</span>

	<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">upper</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
	<span class="n">step</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3c %6c</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="sc">&#39;F&#39;</span><span class="p">,</span><span class="sc">&#39;C&#39;</span><span class="p">);</span>
	<span class="n">fahr</span><span class="o">=</span><span class="n">lower</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">fahr</span><span class="o">&lt;=</span><span class="n">upper</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">celsius</span><span class="o">=</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fahr</span><span class="o">-</span><span class="mf">32.0</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3.0f %6.1f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">fahr</span><span class="p">,</span><span class="n">celsius</span><span class="p">);</span>
		<span class="n">fahr</span> <span class="o">=</span> <span class="n">fahr</span><span class="o">+</span><span class="n">step</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p>Exercise 1-4. Write a program to print the corresponding Celsius to Fahrenheit table.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">float</span> <span class="n">fahr</span><span class="p">,</span><span class="n">celsius</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">step</span><span class="p">;</span>

	<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">upper</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
	<span class="n">step</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3c %6c</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="sc">&#39;C&#39;</span><span class="p">,</span><span class="sc">&#39;F&#39;</span><span class="p">);</span>
	<span class="n">celsius</span><span class="o">=</span><span class="n">lower</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">celsius</span><span class="o">&lt;=</span><span class="n">upper</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">fahr</span><span class="o">=</span><span class="p">(</span><span class="mf">9.0</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span><span class="o">*</span><span class="n">celsius</span><span class="o">+</span><span class="mf">32.0</span><span class="p">;</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3.0f %6.1f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">celsius</span><span class="p">,</span><span class="n">fahr</span><span class="p">);</span>
		<span class="n">celsius</span> <span class="o">=</span> <span class="n">celsius</span><span class="o">+</span><span class="n">step</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<h1 id="for">for语句</h1>
<p>温度转换程序的另一种实现方式：</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cm">/* print Fahrenheit-Celsius table */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">fahr</span><span class="p">;</span>
	
	<span class="k">for</span> <span class="p">(</span><span class="n">fahr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">fahr</span> <span class="o">&lt;=</span> <span class="mi">300</span><span class="p">;</span> <span class="n">fahr</span> <span class="o">=</span> <span class="n">fahr</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3d %6.1f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fahr</span><span class="p">,</span> <span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fahr</span><span class="o">-</span><span class="mi">32</span><span class="p">));</span>
<span class="p">}</span></code></pre></div>

<p>与之前的程序不同，除了<code>fahr</code>之外的变量都精简了，并且<code>fahr</code>为int类型。</p>

<p>除此之外，转换温度的计算并入了<code>printf()</code>语句。这代表了一个通用规则：</p>

<blockquote>
  <p>in any context where it is permissible to use the value of some type,you can use a more complicated expression of that type.</p>
</blockquote>

<p>程序中<code>printf()</code>的第三个参数必须与<code>%6.1f</code>匹配，那么任何浮点型的表达式都可以作为第三个参数。</p>

<p><strong>for语句</strong>属于循环语句，包括<strong>初始化(initialization)</strong>:<code>fahr = 0;</code>，<strong>测试条件(test condition)</strong>:<code>fahr &lt;= 300;</code>，以及
<strong>步进(increment step)</strong>:<code>fahr = fahr + 20</code>。循环在测试条件不满足时终止。</p>

<p><code>for</code>和<code>while</code>之间的选择需要视情况而定。<code>for</code>通常适用于初始化和步进是单一语句并且具有一定联系的情况，相比<code>while</code>更加紧凑，
因为他将循环控制语句放在了同一个地方。</p>

<blockquote>
  <p>Exercise 1-5. Modify the temperature conversion program to print the table in reverse order,that is, from 300 degrees to 0.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cm">/*for version*/</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">float</span> <span class="n">fahr</span><span class="p">,</span><span class="n">celsius</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">step</span><span class="p">;</span>

	<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">upper</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
	<span class="n">step</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3c%6c&quot;</span><span class="p">,</span><span class="sc">&#39;C&#39;</span><span class="p">,</span><span class="sc">&#39;F&#39;</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="n">celsius</span> <span class="o">=</span> <span class="n">upper</span><span class="p">;</span><span class="n">celsius</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">;</span><span class="n">celsius</span> <span class="o">-=</span> <span class="n">step</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">fahr</span> <span class="o">=</span> <span class="p">(</span><span class="mf">9.0</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">celsius</span> <span class="o">+</span> <span class="mf">32.0</span><span class="p">;</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3.0f%6.1f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">celsius</span><span class="p">,</span><span class="n">fahr</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/*while version*/</span>
<span class="c1">//int main(void)</span>
<span class="c1">//{</span>
<span class="c1">//	float fahr,celsius;</span>
<span class="c1">//	int lower,upper,step;</span>
<span class="c1">//</span>
<span class="c1">//	lower = 0;</span>
<span class="c1">//	upper = 300;</span>
<span class="c1">//	step = 20;</span>
<span class="c1">//</span>
<span class="c1">//	printf(&quot;%3c%6c\n&quot;,&#39;C&#39;,&#39;F&#39;);</span>
<span class="c1">//	celsius = upper;</span>
<span class="c1">//	while(celsius &gt;= lower)</span>
<span class="c1">//	{</span>
<span class="c1">//		fahr = (9.0/5.0)*celsius + 32.0;</span>
<span class="c1">//		printf(&quot;%3.0f %6.1f\n&quot;,celsius,fahr);</span>
<span class="c1">//		celsius -= step;</span>
<span class="c1">//	}</span>
<span class="c1">//</span>
<span class="c1">//	return 0;</span>
<span class="c1">//}</span></code></pre></div>

<h1 id="section-2">符号常量</h1>

<p>将300和20这样的”magic numbers”直接放在程序中是一种坏习惯，破坏了程序的可读性，并且难以系统地修改。
一种处理这类”magic numbers”的方法是给他们设置有意义的名称，<code>#define</code>语句为<strong>符号常量(symbolic constant)</strong>
设置一个字符串来表示。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#define name replacement list</span></code></pre></div>

<p>这样一来任何出现<code>name</code>的地方(除了在引号之内或是另外一个名称的一部分之外)都会被替换为相应的<code>replacement text</code>。
<code>name</code>和变量一样，是以字母开头的由字母和数字组成的序列。<code>replacement text</code>不限于数字，可以是任何字符序列。
这样温度转换程序改进如下：</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cp">#define LOWER 0		</span><span class="cm">/* lower limit of table */</span><span class="cp"></span>
<span class="cp">#define UPPER 300		</span><span class="cm">/* upper limit */</span><span class="cp"></span>
<span class="cp">#define STEP 20		</span><span class="cm">/* step size */</span><span class="cp"></span>

<span class="cm">/* print Fahrenheit-Celsius table */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">fahr</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">fahr</span> <span class="o">=</span> <span class="n">LOWER</span><span class="p">;</span> <span class="n">fahr</span> <span class="o">&lt;=</span> <span class="n">UPPER</span><span class="p">;</span> <span class="n">fahr</span> <span class="o">=</span> <span class="n">fahr</span> <span class="o">+</span> <span class="n">STEP</span><span class="p">)</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3d %6.1f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fahr</span><span class="p">,</span> <span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fahr</span><span class="o">-</span><span class="mi">32</span><span class="p">));</span>
<span class="p">}</span></code></pre></div>

<p>注意到<code>#define</code>行并没有以<code>;</code>结束。<code>LOWER</code>，<code>UPPER</code>，<code>STEP</code><strong>并不是</strong>变量,所以不会出现在声明语句中。
符号常量通常采用大写形式书写，这样能与变量名加以区分。</p>

<h1 id="section-3">字符输入/输出</h1>

<p><strong>文本流(text stream)</strong>指划分为行的字符序列，每一行由0个或更多的字符紧跟一个换行符，<strong>标准库</strong>负责确认输入/输出流
的这种规范，使用标准库的C程序员可以不必担心是否符合上述规范。</p>

<p>标准库提供了许多函数来一次读入或是写入一个字符，<code>getchar()</code>和<code>putchar()</code>是最简单的。</p>

<p>每次被调用时，<code>getchar()</code>从文本流中读入_下一个输入字符_并返回它的值，
<code>putchar()</code>输出一个字符。</p>

<h2 id="section-4">文件拷贝</h2>

<p>采用<code>getchar()</code>和<code>putchar()</code>能够一个字符一个字符地将输入拷贝到输出。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cm">/* copy input to output; 1st version*/</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	<span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>关系操作符<code>!=</code>表示”不等于”。</p>

<p><code>char</code>类型专门用来存储字符数据，但是任何整型也可以用来存储字符数据。程序中采用<code>int</code>有重要原因。为了识别输入的终止，
<code>getchar()</code>在输入结束之后返回一个区别于任何有效字符的值，被称为<code>EOF</code>(end of file)。这样一来我们必须将<code>c</code>声明为足够
装下<code>getchar()</code>返回的任何值，我们不能采用<code>char</code>类型，因为<code>c</code>必须能够装下除有效字符(<code>char</code>能存的所有值)以外的其他值
，所以我们采用<code>int</code>。</p>

<p><code>EOF</code>定义在<code>&lt;stdio.h&gt;</code>中，其具体值并不重要，因为不会是<code>char</code>所能表示的任何值，采用符号常量来处理，可以确保程序不依赖于
任何具体数值。</p>

<p>同时，<code>c=getchar();</code>语句本身具有一个值，这个值与赋值运算后赋值符号左边的值一致，这就允许这条赋值语句作为更大的表达式
的一部分，比如将这条赋值语句作为<code>while</code>循环的测试条件。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cm">/* copy input to output; 2nd version */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
		<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p>程序得到变得更加紧凑，并且可读性更强，但同时也更容易出错。</p>

<p>赋值语句两侧的括号是必须的，因为<code>!=</code>的优先级高于<code>=</code>，关系测试会在赋值之前进行。这样一来<code>c=getchar()!=EOF</code>
和<code>c=(getchar()!=EOF)</code>是等价的，将导致<code>c</code>的值不是0就是1.</p>

<blockquote>
  <p>Exercsise 1-6. Verify that the expression getchar() != EOF is 0 or 1.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Press a key.ENTER would be nice :-)</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;The expression </span><span class="se">\&quot;</span><span class="s">getchar()!=EOF</span><span class="se">\&quot;</span><span class="s"> is:%d&quot;</span><span class="p">,</span><span class="n">getchar</span><span class="p">()</span><span class="o">!=</span><span class="n">EOF</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>Linux下使用<code>&lt;Ctrl-D&gt;</code>结束输入，当输入有效字符时，表达式值为1，否则为0.</p>

<blockquote>
  <p>Exercise 1-7. Write a program to print the value of EOF.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;The value of EOF is %d</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">EOF</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>Linux 下<code>&lt;stdio.h&gt;</code>中定义的<code>EOF</code>值为-1.</p>

<h2 id="section-5">字符统计</h2>
<p>统计字符个数的程序：</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cm">/* count characters in input; 1st version */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">long</span> <span class="n">nc</span><span class="p">;</span>
	
	<span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">getchar</span><span class="p">()</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
		<span class="o">++</span><span class="n">nc</span><span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nc</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p><code>++</code>操作符表示自增1，这里也可以使用<code>nc = nc + 1</code>，但是<code>++nc</code>更为简洁和高效。相应的,<code>--</code>对应自减1。
<code>++</code>和<code>--</code>放在变量前和变量后在表达式中具有不同的值，虽然都对变量进行加1或者减1。</p>

<p><code>long</code>整型至少是32位，对应格式化字符<code>%ld</code>，这里使用<code>long</code>整型是因为<code>int</code>类型是16位，最大可表示32767，
这在统计时很容易发生溢出。若要统计更多的字符，可以采用<code>double</code>类型，下面是采用<code>for</code>语句实现的另一个
字符统计版本。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cm">/* count characters in input; 2nd version */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">double</span> <span class="n">nc</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">getchar</span><span class="p">()</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">;</span> <span class="o">++</span><span class="n">nc</span><span class="p">)</span>
		<span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.0f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nc</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p><code>float</code>和<code>double</code>都使用<code>%f</code>来进行格式化，<code>%.0f</code>表示不输出小数点和小数部分(在统计结果中是没有意义的)。</p>

<p>由于所有的工作在测试和步进中完成，<code>for</code>循环体为空，但是C语法要求<code>for</code>语句需要有循环体，所以放置
<strong>空语句(null statement)</strong>来满足语法要求。放在单独一行以增加可读性。</p>

<p>如果被统计的文本为空，则上面两个版本都会输出正确答案0。从这之中可看出<code>while</code>和<code>for</code>语句的优点：在循环
开始之前进行测试。这确保了程序对一些小的扰动(边界条件)仍然能够保证结果正确。</p>

<h2 id="section-6">行统计</h2>
<p>之前提到过，标准库确保输入文本流是行序列，每一行由换行符结束，所以进行行统计等效为统计新行(换行符)。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cm">/* count lines in input */</span>

<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">nl</span><span class="p">;</span>
	
	<span class="n">nl</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
			<span class="o">++</span><span class="n">nl</span><span class="p">;</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nl</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p><code>if</code>语句括号之内条件为真时执行语句(一行或是由<code>{}</code>括起来的多行)，设置缩进能增加可读性。</p>

<p><code>==</code>的意思是”等于”，用两个”=”来和赋值符<code>=</code>加以区分。混淆两者往往会出错，但是编译器不会提醒。</p>

<p>单引号<code>'</code>括起来的字符表示一个整型值，等于机器的字符集中对应的索引值，称为<strong>字符常量(character constant)</strong>。
如字符’A’是一个字符常量，在_ASCII字符集_中的值为65，同时也是字符’A’的内部表示方法。当然，使用’A’比使用65
要好，因为显式含义，并且独立于字符集。</p>

<p>字符串常量中的转义字符仍然是合法的字符常量，’\n’表示换行符，在ASCII中的值为10。需要注意的是<code>\n</code>仅仅代表一个字符。</p>

<blockquote>
  <p>Exercise 1-8. Write a program to count blanks, tabs, and newlines.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">blanks</span><span class="p">,</span><span class="n">tabs</span><span class="p">,</span><span class="n">newlines</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">lastchar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">blanks</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">tabs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">newlines</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">while</span><span class="p">(</span><span class="n">done</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>

		<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>
			<span class="o">++</span><span class="n">blanks</span><span class="p">;</span>
		
		<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\t&#39;</span><span class="p">)</span>
			<span class="o">++</span><span class="n">tabs</span><span class="p">;</span>

		<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
			<span class="o">++</span><span class="n">newlines</span><span class="p">;</span>

		<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">lastchar</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="o">++</span><span class="n">newlines</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">done</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		
		<span class="n">lastchar</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Blanks:%d</span><span class="se">\n</span><span class="s">Tabs:%d</span><span class="se">\n</span><span class="s">Newlines:%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">blanks</span><span class="p">,</span><span class="n">tabs</span><span class="p">,</span><span class="n">newlines</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>在判断<code>EOF</code>时测试<code>EOF</code>之前的字符是为了处理某些不以换行符结束的文件。</p>

<blockquote>
  <p>Exercise 1-9. Write a program to copy its input to its output, replacing each string of one or more blanks by a single blank.</p>
</blockquote>

<p>方法一：设置一个<code>inspace</code>变量来标志当前处理的字符是否为空格。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">inspace</span><span class="p">;</span>
  <span class="n">inspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span><span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="n">inspace</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">inspace</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="cm">/* We haven&#39;t met &#39;else&#39; yet, so we have to be a little clumsy */</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">inspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>方法二：记录之前的一个字符来判断是否输出当前空格。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
 
<span class="cm">/* count lines in input */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
        <span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">pc</span><span class="p">;</span> <span class="cm">/* c = character, pc = previous character */</span>
 
        <span class="cm">/* set pc to a value that wouldn&#39;t match any character, in case</span>
<span class="cm">        this program is ever modified to get rid of multiples of other</span>
<span class="cm">        characters */</span>
 
        <span class="n">pc</span> <span class="o">=</span> <span class="n">EOF</span><span class="p">;</span>
 
        <span class="k">while</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">pc</span> <span class="o">!=</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>   <span class="cm">/* or if (pc != c) */</span> 
                                <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
 
                <span class="cm">/* We haven&#39;t met &#39;else&#39; yet, so we have to be a little clumsy */</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>
                        <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
                <span class="n">pc</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
        <span class="p">}</span>
 
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>方法三：当出现一个空格后，就把之后可能紧接着出现的空格全部跳过。注意为什么使用<code>break</code>
那里还需要判定是否为<code>EOF</code>.</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>

	<span class="k">while</span><span class="p">((</span><span class="n">c</span><span class="o">=</span><span class="n">getchar</span><span class="p">())</span><span class="o">!=</span><span class="n">EOF</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39; &#39;</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
			<span class="k">while</span><span class="p">((</span><span class="n">c</span><span class="o">=</span><span class="n">getchar</span><span class="p">())</span><span class="o">==</span><span class="sc">&#39; &#39;</span><span class="o">&amp;&amp;</span><span class="n">c</span><span class="o">!=</span><span class="n">EOF</span><span class="p">)</span>
			<span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="n">EOF</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p>Exercise 1-10. Write a program to copy its input to its output, replacing each tab by \t, each
  backspace by \b, and each backslash by \. This makes tabs and backspaces visible in an
  unambiguous way.</p>
</blockquote>

<p>方法一：变量<code>d</code>用来标志是否出现了需要处理的三种符号，如果出现则进行处理并将<code>d</code>置1。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">;</span>

	<span class="k">while</span><span class="p">((</span><span class="n">c</span><span class="o">=</span><span class="n">getchar</span><span class="p">())</span><span class="o">!=</span><span class="n">EOF</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">d</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39;\\&#39;</span><span class="p">){</span>
			<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\\&#39;</span><span class="p">);</span>
			<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\\&#39;</span><span class="p">);</span>
			<span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39;\t&#39;</span><span class="p">){</span>
			<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\\&#39;</span><span class="p">);</span>
			<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;t&#39;</span><span class="p">);</span>
			<span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39;\b&#39;</span><span class="p">){</span>
			<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\\&#39;</span><span class="p">);</span>
			<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;b&#39;</span><span class="p">);</span>
			<span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>方法二：定义一个符号常量<code>ESC_CHAR</code>来识别反斜杠。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
 
<span class="cp">#define ESC_CHAR &#39;\\&#39;</span>
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
 
  <span class="k">while</span><span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">case</span> <span class="sc">&#39;\b&#39;</span>:
        <span class="n">putchar</span><span class="p">(</span><span class="n">ESC_CHAR</span><span class="p">);</span>
        <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;b&#39;</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">&#39;\t&#39;</span>:
        <span class="n">putchar</span><span class="p">(</span><span class="n">ESC_CHAR</span><span class="p">);</span>
        <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;t&#39;</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="n">ESC_CHAR</span>:
        <span class="n">putchar</span><span class="p">(</span><span class="n">ESC_CHAR</span><span class="p">);</span>
        <span class="n">putchar</span><span class="p">(</span><span class="n">ESC_CHAR</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="nl">default:</span>
        <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<h2 id="section-7">单词统计</h2>
<p>定义”单词”为不包含空格，制表符或是换行符的字符序列。单词统计和UNIX系统程序<code>wc</code>类似。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#define IN 1	</span><span class="cm">/* inside a word */</span><span class="cp"></span>
<span class="cp">#define OUT 0	</span><span class="cm">/* outside a word */</span><span class="cp"></span>

<span class="cm">/* count lines, words, and characters in input */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">nl</span><span class="p">,</span> <span class="n">nw</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">state</span><span class="p">;</span>
	
	<span class="n">state</span> <span class="o">=</span> <span class="n">OUT</span><span class="p">;</span>
	<span class="n">nl</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">=</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span> <span class="p">{</span>
		<span class="o">++</span><span class="n">nc</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
			<span class="o">++</span><span class="n">nl</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\t&#39;</span><span class="p">)</span>
			<span class="n">state</span> <span class="o">=</span> <span class="n">OUT</span><span class="p">;</span>
		<span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">OUT</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">state</span> <span class="o">=</span> <span class="n">IN</span><span class="p">;</span>
			<span class="o">++</span><span class="n">nw</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d %d %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nl</span><span class="p">,</span> <span class="n">nw</span><span class="p">,</span> <span class="n">nc</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p>每次程序处理到一个单词的开头的时候，就将单词计数加1，<code>state</code>变量配合符号常量<code>IN</code>和<code>OUT</code>用来记录当前处理的字符是否在一
个单词内，初始化设置为<code>OUT</code>。使用<code>IN</code>和<code>OUT</code>而不是<code>1</code>和<code>0</code>，K&amp;R说明如下。</p>

<blockquote>
  <p>In a program as tiny as this, it makes little difference, but in larger programs, the increase in clarity is well worth the
modest extra effort to write it this way from the beginning. </p>
</blockquote>

<p><code>nl = nw = nc = 0;</code>这条语句基于这样一个事实，即C的赋值语句从右到左进行，则这条语句和<code>nl = (nw = (nc = 0));</code>是等效的。</p>

<p><code>||</code>是<strong>逻辑或</strong>操作符，相应的<code>&amp;&amp;</code>表示<strong>逻辑与</strong>操作符(优先级比<code>||</code>高)。逻辑表达式的值从左到右计算，并且一旦确定表达式的值
之后就不再进行运算(短路运算)，这在很多复杂场合是非常有用的。</p>

<p><code>else</code>用来处理<code>if</code>后面的条件不满足时(还有剩下的许多可能)的场合，不难想到这两个分支一次只会执行一个。</p>

<blockquote>
  <p>Exercise 1-11. How would you test the word count program? What kinds of input are most
likely to uncover bugs if there are any?</p>
</blockquote>

<p>可以采用下面的测试方法(有点单元测试的思想)：</p>

<ul>
  <li>包含0个单词的输入文件</li>
  <li>包含一个非常长的单词而不换行的输入文件</li>
  <li>包含所有空白符(‘\f’,’\t’,’\v’)而没有换行符的输入文件</li>
  <li>包含66000个换行符的输入文件(注意<code>unsigned int</code>可以表示的整数范围)</li>
  <li>在单词之间设置大量的空白符号序列</li>
  <li>包含66000个只有一个字母的单词，每行66个</li>
  <li>包含66000个单词，没有换行</li>
  <li>采用<code>/usr/dict</code>目录下的文件作为输入(在ubuntu中为<code>/usr/share/dict/words</code>)</li>
  <li>输入文件包含大量的长单词</li>
  <li>将可执行文件(二进制)作为输入</li>
  <li>将<code>dev/null</code>作为输入</li>
</ul>

<p>下面是用来产生符合前7条测试规则的测试文件的程序：</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;assert.h&gt;</span>
<span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">FILE</span> <span class="o">*</span><span class="n">f</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">static</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ws</span> <span class="o">=</span> <span class="s">&quot; </span><span class="se">\f\t\v</span><span class="s">&quot;</span><span class="p">;</span>
	<span class="k">static</span> <span class="kt">char</span> <span class="o">*</span><span class="n">al</span> <span class="o">=</span> <span class="s">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">;</span>
	<span class="k">static</span> <span class="kt">char</span> <span class="o">*</span><span class="n">i5</span> <span class="o">=</span> <span class="s">&quot;a b c d e f g h i j k l m &quot;</span>
					  <span class="s">&quot;n o p q r s t u v w x y z &quot;</span>
					  <span class="s">&quot;a b c d e f g h i j k l m &quot;</span>
					  <span class="s">&quot;n o p q r s t u v w x y z &quot;</span>
					  <span class="s">&quot;a b c d e f g h i j k l m &quot;</span>
					  <span class="s">&quot;n</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
							
	<span class="cm">/* 生成如下规则: */</span>
	<span class="cm">/* 包含0个单词的输入文件 */</span>
	<span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;test0&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">(</span><span class="n">f</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

	<span class="cm">/* 包含一个非常长的单词而不换行的输入文件 */</span>
	<span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;test1&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">(</span><span class="n">f</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">((</span><span class="mi">66000ul</span> <span class="o">/</span> <span class="mi">26</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">fputs</span><span class="p">(</span><span class="n">al</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
	
	<span class="cm">/* 包含所有空白符而没有换行符的输入文件 */</span>
	<span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;test2&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">(</span><span class="n">f</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">((</span><span class="mi">66000ul</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">fputs</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

	<span class="cm">/* 包含66000个换行符的输入文件 */</span>
	<span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;test3&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">(</span><span class="n">f</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">66000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">fputc</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

	<span class="cm">/* 在单词之间设置大量的空白符号序列 */</span>
	<span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;test4&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">(</span><span class="n">f</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">fputs</span><span class="p">(</span><span class="s">&quot;word&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">((</span><span class="mi">66000ul</span> <span class="o">/</span> <span class="mi">26</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">fputs</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="n">fputs</span><span class="p">(</span><span class="s">&quot;word&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

	<span class="cm">/* 包含66000个只有一个字母的单词，每行66个 */</span>
	<span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;test5&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">(</span><span class="n">f</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">fputs</span><span class="p">(</span><span class="n">i5</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

	<span class="cm">/* 包含66000个单词，没有换行 */</span>
	<span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;test6&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">(</span><span class="n">f</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">66000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">fputs</span><span class="p">(</span><span class="s">&quot;word &quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
	
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p>Exercise 1-12. Write a program that prints its input one word per line.</p>
</blockquote>

<p>同样使用<code>inspace</code>来标识当前处理的字符是否在单词之间，在必要的时候换行。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">inspace</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

	<span class="k">while</span><span class="p">((</span><span class="n">c</span><span class="o">=</span><span class="n">getchar</span><span class="p">())</span><span class="o">!=</span><span class="n">EOF</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39; &#39;</span><span class="o">||</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39;\t&#39;</span><span class="o">||</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39;\n&#39;</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">inspace</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">inspace</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
				<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="n">inspace</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<h1 id="section-8">数组</h1>
<p>如果要用程序来统计数字(0-9)，空白字符以及其他字符的出现次数，那么使用数组来记录结果要比采用10个变量来记录10个数字要好。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cm">/* count digits, white space, others */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">nwhite</span><span class="p">,</span> <span class="n">nother</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ndigit</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
	
	<span class="n">nwhite</span> <span class="o">=</span> <span class="n">nother</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">ndigit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	
	<span class="k">while</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;9&#39;</span><span class="p">)</span>
			<span class="o">++</span><span class="n">ndigit</span><span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="sc">&#39;0&#39;</span><span class="p">];</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\t&#39;</span><span class="p">)</span>
			<span class="o">++</span><span class="n">nwhite</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="o">++</span><span class="n">nother</span><span class="p">;</span>
	
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;digits =&quot;</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot; %d&quot;</span><span class="p">,</span> <span class="n">ndigit</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;, white space = %d, other = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		<span class="n">nwhite</span><span class="p">,</span> <span class="n">nother</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p><code>int ndigit[10];</code>声明一个可以存放10个整数的数组，数组索引从0开始，所以10个元素为<code>ndigit[0]</code>,<code>ndigit[1]</code>,…,<code>ndigit[9]</code>，
从for语句中可以看出这种规定。数组的索引值可以采用任何整型表达式。</p>

<p><code>if (c &gt;= '0' &amp;&amp; c &lt;= '9')</code>用来测试<code>c</code>是否是一个数字，如果是，则其实际数值为<code>c - '0'</code>，这依赖于所采用的字符集内数字的编码
是连续的，所幸所有的字符集都是这样给数字编码的。</p>

<p>程序处理其他情况(不是数字)时引入了<code>else if</code>，这样提供了一种处理多分支条件的机制(<code>switch</code>也可以用来处理)。分支从上到下进行
判断直到某个分支的条件满足，然后执行对应分支的语句。</p>

<p>在多分支甚至存在分支嵌套的情况下，严格使用缩进是比较好的编码风格。</p>

<blockquote>
  <p>Exercise 1-13. Write a program to print a histogram of the lengths of words in its input. It is
easy to draw the histogram with the bars horizontal; a vertical orientation is more challenging.</p>
</blockquote>

<p>用垂直直方图输出结果的程序如下。理解这个程序有几个难点。其一是各个变量的用途，在注释中标出。其二
是<code>inspace</code>和<code>firstletter</code>这两个变量，将<code>firstletter</code>初始化为1的目的是控制输入开头时模拟为刚处理
完一个单词，在程序一开始就将其置0。其三是格式化输出垂直直方图的方法，之所以记录<code>maxval</code>也是为输出
直方图服务的。特别需要注意变量初始化是不能偷懒的，比如<code>maxval</code>，因为单词长度大于零才会被统计，所以
初始化其为0是合理的。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="cp">#define MAXLEN 10</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">inspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">firstletter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">wordlen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">maxval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">thisval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">thisindex</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">lengtharr</span><span class="p">[</span><span class="n">MAXLEN</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">done</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

	<span class="k">for</span><span class="p">(</span><span class="n">thisindex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisindex</span><span class="o">&lt;=</span><span class="n">MAXLEN</span><span class="p">;</span><span class="n">thisindex</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">lengtharr</span><span class="p">[</span><span class="n">thisindex</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">done</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">c</span><span class="o">=</span><span class="n">getchar</span><span class="p">();</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39; &#39;</span><span class="o">||</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39;\t&#39;</span><span class="o">||</span><span class="n">c</span><span class="o">==</span><span class="sc">&#39;\n&#39;</span><span class="o">||</span><span class="n">c</span><span class="o">==</span><span class="n">EOF</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">inspace</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">firstletter</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
				<span class="n">inspace</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
				
				<span class="k">if</span><span class="p">(</span><span class="n">wordlen</span><span class="o">&lt;=</span><span class="n">MAXLEN</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="k">if</span><span class="p">(</span><span class="n">wordlen</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
					<span class="p">{</span>
						<span class="n">thisval</span> <span class="o">=</span> <span class="o">++</span><span class="n">lengtharr</span><span class="p">[</span><span class="n">wordlen</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
						<span class="k">if</span><span class="p">(</span><span class="n">thisval</span><span class="o">&gt;</span><span class="n">maxval</span><span class="p">)</span>
						<span class="p">{</span>
							<span class="n">maxval</span><span class="o">=</span><span class="n">thisval</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">else</span>
				<span class="p">{</span>
					<span class="n">thisval</span><span class="o">=++</span><span class="n">lengtharr</span><span class="p">[</span><span class="n">MAXLEN</span><span class="p">];</span>
					<span class="k">if</span><span class="p">(</span><span class="n">thisval</span><span class="o">&gt;</span><span class="n">maxval</span><span class="p">)</span>
					<span class="p">{</span>
						<span class="n">maxval</span><span class="o">=</span><span class="n">thisval</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="n">EOF</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">done</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">inspace</span><span class="o">==</span><span class="mi">1</span><span class="o">||</span><span class="n">firstletter</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">wordlen</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
				<span class="n">firstletter</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
				<span class="n">inspace</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="o">++</span><span class="n">wordlen</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="k">for</span><span class="p">(</span><span class="n">thisval</span><span class="o">=</span><span class="n">maxval</span><span class="p">;</span><span class="n">thisval</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span><span class="n">thisval</span><span class="o">--</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%4d|&quot;</span><span class="p">,</span><span class="n">thisval</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="n">thisindex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisindex</span><span class="o">&lt;=</span><span class="n">MAXLEN</span><span class="p">;</span><span class="n">thisindex</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">lengtharr</span><span class="p">[</span><span class="n">thisindex</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">thisval</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;   *&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">else</span>
			<span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;    &quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;    +&quot;</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="n">thisindex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisindex</span><span class="o">&lt;=</span><span class="n">MAXLEN</span><span class="p">;</span><span class="n">thisindex</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;----&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">     &quot;</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="n">thisindex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisindex</span><span class="o">&lt;</span><span class="n">MAXLEN</span><span class="p">;</span><span class="n">thisindex</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%4d&quot;</span><span class="p">,</span><span class="n">thisindex</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;  &gt;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">MAXLEN</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p>Exercise 1-14. Write a program to print a histogram of the frequencies of different characters
in its input.</p>
</blockquote>

<p>由于字符集内的字符并不是都可见，所以输出统计信息是采用其ASCII码来标注是比较合理的方法。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="cp">#define NUM_CHARS 256</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">freqarr</span><span class="p">[</span><span class="n">NUM_CHARS</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>		<span class="cm">/* 记录统计信息 */</span>

	<span class="kt">long</span> <span class="n">thisval</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">thisidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	
	<span class="cm">/* 初始化统计结果 */</span>
	<span class="k">for</span><span class="p">(</span><span class="n">thisidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisidx</span><span class="o">&lt;=</span><span class="n">NUM_CHARS</span><span class="p">;</span><span class="n">thisidx</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">freqarr</span><span class="p">[</span><span class="n">thisidx</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">while</span><span class="p">((</span><span class="n">c</span><span class="o">=</span><span class="n">getchar</span><span class="p">())</span><span class="o">!=</span><span class="n">EOF</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">&lt;</span><span class="n">NUM_CHARS</span><span class="p">)</span>  <span class="cm">/* 字符值小于256 */</span>
		<span class="p">{</span>
			<span class="n">thisval</span><span class="o">=++</span><span class="n">freqarr</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
			<span class="k">if</span><span class="p">(</span><span class="n">thisval</span><span class="o">&gt;</span><span class="n">maxval</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">maxval</span><span class="o">=</span><span class="n">thisval</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">else</span>	<span class="cm">/*字符值大于等于256 */</span>
		<span class="p">{</span>
			<span class="n">thisval</span><span class="o">=++</span><span class="n">freqarr</span><span class="p">[</span><span class="n">NUM_CHARS</span><span class="p">];</span>
			<span class="k">if</span><span class="p">(</span><span class="n">thisval</span><span class="o">&gt;</span><span class="n">maxval</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">maxval</span><span class="o">=</span><span class="n">thisval</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="cm">/* 格式化输出结果 */</span>
	<span class="k">for</span><span class="p">(</span><span class="n">thisval</span><span class="o">=</span><span class="n">maxval</span><span class="p">;</span><span class="n">thisval</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span><span class="n">thisval</span><span class="o">--</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%4ld |&quot;</span><span class="p">,</span><span class="n">thisval</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="n">thisidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisidx</span><span class="o">&lt;</span><span class="n">NUM_CHARS</span><span class="p">;</span><span class="n">thisidx</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">freqarr</span><span class="p">[</span><span class="n">thisidx</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">thisval</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">freqarr</span><span class="p">[</span><span class="n">thisidx</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;     +&quot;</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="n">thisidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisidx</span><span class="o">&lt;=</span><span class="n">NUM_CHARS</span><span class="p">;</span><span class="n">thisidx</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">freqarr</span><span class="p">[</span><span class="n">thisidx</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">      &quot;</span><span class="p">);</span>
	
	<span class="cm">/* 按位输出字符ASCII码值 */</span>
	<span class="k">for</span><span class="p">(</span><span class="n">thisidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisidx</span><span class="o">&lt;</span><span class="n">NUM_CHARS</span><span class="p">;</span><span class="n">thisidx</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">freqarr</span><span class="p">[</span><span class="n">thisidx</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="n">thisidx</span><span class="o">/</span><span class="mi">100</span><span class="p">);</span> 	<span class="cm">/* 百位 */</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">      &quot;</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="n">thisidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisidx</span><span class="o">&lt;</span><span class="n">NUM_CHARS</span><span class="p">;</span><span class="n">thisidx</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">freqarr</span><span class="p">[</span><span class="n">thisidx</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,(</span><span class="n">thisidx</span><span class="o">-</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">thisidx</span><span class="o">/</span><span class="mi">100</span><span class="p">)))</span><span class="o">/</span><span class="mi">10</span><span class="p">);</span>	<span class="cm">/* 十位 */</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">      &quot;</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="n">thisidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">thisidx</span><span class="o">&lt;</span><span class="n">NUM_CHARS</span><span class="p">;</span><span class="n">thisidx</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">freqarr</span><span class="p">[</span><span class="n">thisidx</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="n">thisidx</span><span class="o">-</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">thisidx</span><span class="o">/</span><span class="mi">10</span><span class="p">)));</span>  <span class="cm">/* 个位 */</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="cm">/* 字符值大于256的结果输出 */</span>
	<span class="k">if</span><span class="p">(</span><span class="n">freqarr</span><span class="p">[</span><span class="n">NUM_CHARS</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;&gt;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">NUM_CHARS</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<h1 id="section-9">函数</h1>

<p><strong>函数</strong>提供了封装一些操作的实现，优点是可以在不了解其具体实现的情况下进行调用。K&amp;R如此形容：</p>

<blockquote>
  <p>With properly designed functions,it is possible to ignore <strong>how</strong> a job is done;knowing  <strong>what</strong> is done is sufficient.</p>
</blockquote>

<p>下面程序使用的用<code>pow(m,n)</code>可以计算m的n次幂，虽然这不是效率最高的实现，但足够用来描述函数的一些概念：</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">power</span><span class="p">(</span><span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">);</span>

<span class="cm">/* test power function */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d %d %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">));</span>
	
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* power: raise base to n-th power; n &gt;= 0 */</span>
<span class="kt">int</span> <span class="n">power</span><span class="p">(</span><span class="kt">int</span> <span class="n">base</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span><span class="p">;</span>
	
	<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">base</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">p</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>函数按照程序中给定的方式来定义，需要给定<strong>返回类型(return-type)</strong>,<strong>函数名(function-name)</strong>,<strong>参数声明(parameter declarations)</strong>
以及函数体内的<strong>变量定义(declarations)</strong>和<strong>语句(statements)</strong>。函数定义可以任何顺序出现，可以存在于一个源文件或多个源文件中，但
同一个函数不能分开来定义。</p>

<p><code>power()</code>使用的参数名字对其他函数不可见，其他函数可以使用相同的参数名字而不发生冲突，例如<code>main()</code>中的<code>i</code>和<code>power()</code>中的<code>i</code>并不相关
。</p>

<p>函数需要采用<code>return expression;</code>来返回一个值给调用者，<code>expression</code>可以省略，此时<code>return;</code>只起控制作用，不返回任何值。<code>main()</code>函数
和其它函数一样，也要返回一个值，一般来说，返回0表示正常退出，返回非零值表示异常或错误退出。此后都将对<code>main()</code>设置返回语句，K&amp;R：</p>

<blockquote>
  <p>but we will include them hereafter,as a reminder that programs should return status to their environment.</p>
</blockquote>

<p>在<code>main()</code>之前的<code>int power(int base, int n);</code>称为<strong>函数原型(function prototype)</strong>，声明<code>power()</code>是一个接收两个int参数并且返回int值
的函数，函数原型需要和定义以及调用相匹配，但参数名字并不需要匹配，并且在函数原型中可以省略，也就是说<code>int power(int, int);</code>和程序
中的函数原型是等效的。</p>

<p><strong>ANSI C</strong>和之前标准的最大的改进在于函数的声明和定义，在以前的标准中，<code>power()</code>的定义将会是这样子：</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/* power: raise base to n-th power; n &gt;= 0 */</span>
<span class="cm">/*(old-style version) */</span>
<span class="n">power</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="kt">int</span> <span class="n">base</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span><span class="p">;</span>
	
	<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">base</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">p</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>参数名在括号内给定，其类型在花括号前声明，缺省为<code>int</code>类型。</p>

<p><code>power()</code>的声明将会是<code>int power();</code>，并没有参数列表，所以编译器不能即时检查<code>power()</code>是否被正确调用。相比之下，新语法标准
允许编译器更容易检测参数数量和类型的错误，建议使用新标准。</p>

<blockquote>
  <p>The old style of declaration and definition still works
in ANSI C, at least for a transition period, but we strongly recommend that you use the new
form when you have a compiler that supports it.</p>
</blockquote>

<blockquote>
  <p>Exercise 1.15. Rewrite the temperature conversion program of Section 1.2 to use a function
 for conversion.</p>
</blockquote>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;stdio.h&gt;</span>

<span class="kt">float</span> <span class="nf">FtoC</span><span class="p">(</span><span class="kt">float</span> <span class="n">f</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">float</span> <span class="n">c</span><span class="p">;</span>
	<span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="mf">32.0</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">c</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">float</span> <span class="n">fahr</span><span class="p">,</span><span class="n">celsius</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">step</span><span class="p">;</span>

	<span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="n">upper</span><span class="o">=</span><span class="mi">300</span><span class="p">;</span>
	<span class="n">step</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span>

	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;F    C</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">fahr</span><span class="o">=</span><span class="n">lower</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">fahr</span><span class="o">&lt;=</span><span class="n">upper</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">celsius</span><span class="o">=</span><span class="n">FtoC</span><span class="p">(</span><span class="n">fahr</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3.0f %6.1f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">fahr</span><span class="p">,</span><span class="n">celsius</span><span class="p">);</span>
		<span class="n">fahr</span><span class="o">=</span><span class="n">fahr</span><span class="o">+</span><span class="n">step</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<h1 id="section-10">参数-传值调用</h1>

<p>在C中，所有的函数参数都通过<strong>值传递(passed by value)</strong>，这意味着被调用的函数接收了存在临时变量中的参数值而不是原始变量。</p>

<blockquote>
  <p>It usually leads to more compact programs with fewer extraneous variables,because parameters can be treated as 
conveniently initialized local variables in the called routine.</p>
</blockquote>

<p>利用这种特性，可以写出另外一种<code>power()</code>的实现</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/* power: raise base to n-th power; n &gt;= 0; version 2 */</span>
<span class="kt">int</span> <span class="nf">power</span><span class="p">(</span><span class="kt">int</span> <span class="n">base</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">p</span><span class="p">;</span>
	
	<span class="k">for</span> <span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">n</span><span class="p">)</span>
		<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">base</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">p</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>参数<code>n</code>是一个临时变量，用它来控制循环，则不需要额外设置<code>i</code>变量，函数内无论对<code>n</code>怎么操作都不会影响到<code>power()</code>调用的原始变量。</p>

<p>同时，必要的时候也需要在调用过程中修改一个变量的值，这时调用函数需要提供目标变量的<strong>地址(address)</strong>(<strong>指针(pointer)</strong>)，并且
调用函数必须将参数声明为指针类型，然后间接地通过这个指针来访问变量。</p>

<p>但是，数组则不是这样，当数组的名字被用作参数时，传递给函数的值是数组起始元素的地址，而不会另外创建数组的拷贝。</p>

<h1 id="section-11">字符数组</h1>
<p>C中最常用的数组是<strong>字符数组(Character Arrays)</strong>，为了描述字符数组的使用，下面的程序用来读入文本行序列然后打印最长的文本行。</p>

<ul>
  <li>读入行到输入结束</li>
  <li>如果比之前的最长行长，保存最长行及其长度</li>
  <li>读入结束后输出最长行</li>
</ul>

<p>为了实现流程，首先实现一个函数<code>getline()</code>来读入下一行输入，<code>getline()</code>要能够返回标识文件结束的信号，可以采用<code>0</code>来表示文件
结束，因为所有有效文本行的长度都不会是0，即使是只包含一个换行符的文本行的长度都是1。然后需要实现一个函数<code>copy()</code>来将得到的
新的最长行拷贝到安全的位置。最后使用<code>main()</code>函数来调用前两者达到目的。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#define MAXLINE 1000	</span><span class="cm">/* maximum input line length */</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">getline</span><span class="p">(</span><span class="kt">char</span> <span class="n">line</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">maxline</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">char</span> <span class="n">to</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">from</span><span class="p">[]);</span>

<span class="cm">/* print the longest input */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">len</span><span class="p">;</span>	<span class="cm">/* current line length */</span>
	<span class="kt">int</span> <span class="n">max</span><span class="p">;</span>	<span class="cm">/* maximum length seen so far */</span>
	<span class="kt">char</span> <span class="n">line</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span>		<span class="cm">/* current input line */</span>
	<span class="kt">char</span> <span class="n">longest</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span>	<span class="cm">/* longest line saved here */</span>
	
	<span class="n">max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">getline</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">MAXLINE</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&gt;</span> <span class="n">max</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">max</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
			<span class="n">copy</span><span class="p">(</span><span class="n">longest</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">max</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="cm">/* there was a line */</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">longest</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* getline: read a line into s, return length */</span>
<span class="kt">int</span> <span class="n">getline</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[],</span><span class="kt">int</span> <span class="n">lim</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">lim</span><span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">getchar</span><span class="p">())</span><span class="o">!=</span><span class="n">EOF</span> <span class="o">&amp;&amp;</span> <span class="n">c</span><span class="o">!=</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* copy: copy &#39;from&#39; into &#39;to&#39;; assume to is big enough */</span>
<span class="kt">void</span> <span class="n">copy</span><span class="p">(</span><span class="kt">char</span> <span class="n">to</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">from</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">to</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>注意，上面这个函数使用gcc编译时会报错，因为<code>stdio.h</code>中已经对<code>getline()</code>进行了定义。将<code>getline()</code>改成其它名字能够
解决这个问题。</p>

<p>在<code>int getline(char s[],int lim);</code>的函数声明中，并不必要指定数组的长度(对数组进行声明时指定长度是为了分配内存)。
<code>copy()</code>不返回任何值，所以是<code>void</code>类型，表示不返回值。</p>

<p><code>getline()</code>在数组的结尾设置一个’\0’来标识字符串的结尾，字符串在数组中也是按照”字符串字符+\0”来存储的，格式化字符串<code>%s</code>
要求相应的参数是这种形式表示的，<code>copy()</code>也依赖于这种表示形式。</p>

<p>如果某一行长到超过了数组的长度，<code>getline()</code>在数组收集满之后仍然会继续工作，这会造成一些扰动。<code>main()</code>函数可以通过判断
行的长度以及最后一个字符来判定是否出现了这种情况。</p>

<p><code>getline()</code>事先并不知道输入行的长度，所以需要设置溢出处理，但是<code>copy()</code>调用时已经知道了字符串的长度，所以可以省掉溢出
检查。</p>

<blockquote>
  <p>Exercise 1-16. Revise the main routine of the longest-line program so it will correctly print
the length of arbitrary long input lines, and as much as possible of the text.</p>
</blockquote>

<p>方法一：修改<code>getline()</code>函数，使之返回文本行的实际长度而不是写入数组的字符个数，程序为了实现这个功能新增加了
一个变量，这样<code>j</code>用来控制写入数组，<code>i</code>用来记录字符串长度。将<code>getline()</code>格外
命名以免编译器报错。程序每读入一行，就输出当前行的长度及字符串，在输入结束以后，输出最长行及其长度。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cp">#define MAXLINE 1000 </span><span class="cm">/* maximum input line size */</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">getline_1</span><span class="p">(</span><span class="kt">char</span> <span class="n">line</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">maxline</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">char</span> <span class="n">to</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">from</span><span class="p">[]);</span>

<span class="cm">/* print longest input line */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">len</span><span class="p">;</span> <span class="cm">/* current line length */</span>
	<span class="kt">int</span> <span class="n">max</span><span class="p">;</span> <span class="cm">/* maximum length seen so far */</span>
	<span class="kt">char</span> <span class="n">line</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span>	<span class="cm">/* current input line */</span>
	<span class="kt">char</span> <span class="n">longest</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span> <span class="cm">/* longest line saved here */</span>
	
	<span class="n">max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">while</span><span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">getline_1</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">MAXLINE</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d: %s&quot;</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
		
		<span class="k">if</span><span class="p">(</span><span class="n">len</span> <span class="o">&gt;</span> <span class="n">max</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">max</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
			<span class="n">copy</span><span class="p">(</span><span class="n">longest</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">max</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Longest is %d characters:</span><span class="se">\n</span><span class="s">%s&quot;</span><span class="p">,</span> <span class="n">max</span><span class="p">,</span> <span class="n">longest</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* getline_1: read a line into s, return length */</span>
<span class="kt">int</span> <span class="nf">getline_1</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">lim</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
	
	<span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span><span class="o">!=</span><span class="n">EOF</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">lim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* copy: copy &#39;from&#39; into &#39;to&#39;; assume &#39;to&#39; is big enough */</span>
<span class="kt">void</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">char</span> <span class="n">to</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">from</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	
	<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">((</span><span class="n">to</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>方法二：这个方法对题目进行了更深刻的理解(和中文译本上的差不多)，首先是修改<code>main()</code>程序，其次是实现
“输出任意长的长度的同时尽可能多地输出字符(20个)”。理解程序的难点依旧在理解每个变量的作用。程序使用
<code>getmore</code>来控制继续读取超出数组存储之外而又在换行符之前的字符，<code>temp</code>在必要的时候记录字符串开始的
段，<code>prevmax</code>用来实现统计任意长度的输入，每次超出数组存储长度而又没有换行时进行长度累加。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cp">#define MAXLINE 20</span>

<span class="kt">int</span> <span class="nf">getline_1</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">lim</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">char</span> <span class="n">to</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">from</span><span class="p">[]);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">line</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">longest</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">temp</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="n">max</span><span class="p">,</span> <span class="n">prevmax</span><span class="p">,</span> <span class="n">getmore</span><span class="p">;</span>
	
	<span class="n">max</span> <span class="o">=</span> <span class="n">prevmax</span> <span class="o">=</span> <span class="n">getmore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">getline_1</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">MAXLINE</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">getmore</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
				<span class="n">copy</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
			<span class="n">prevmax</span> <span class="o">+=</span> <span class="n">len</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">max</span> <span class="o">&lt;</span> <span class="n">prevmax</span><span class="p">)</span>
				<span class="n">max</span> <span class="o">=</span> <span class="n">prevmax</span><span class="p">;</span>
			<span class="n">getmore</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">getmore</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="n">max</span> <span class="o">&lt;</span> <span class="n">prevmax</span> <span class="o">+</span> <span class="n">len</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">max</span> <span class="o">=</span> <span class="n">prevmax</span> <span class="o">+</span> <span class="n">len</span><span class="p">;</span>
					<span class="n">copy</span><span class="p">(</span><span class="n">longest</span><span class="p">,</span> <span class="n">temp</span><span class="p">);</span>
					<span class="n">longest</span><span class="p">[</span><span class="n">MAXLINE</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">getmore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">max</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">max</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
				<span class="n">copy</span><span class="p">(</span><span class="n">longest</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">prevmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">max</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">longest</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;len = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">max</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">getline_1</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">lim</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">i</span> <span class="o">&lt;</span> <span class="n">lim</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">);</span>
		<span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
	
	<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">EOF</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="cm">/* gotta do something about no newline preceding EOF */</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">char</span> <span class="n">to</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">from</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	
	<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">((</span><span class="n">to</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p>Exercise 1-17. Write a program to print all input lines that are longer than 80 characters.</p>
</blockquote>

<p>遇到此类问题时，需要注意边界情况。输出长度大于80的字符串，设置符号常量<code>MINLENGTH</code>为81，当输入字符串包括80个有
效字符加一个换行符的边界情况时，<code>readbuff()</code>会在遇到换行符时返回0，这样<code>main()</code>不会判定为满足长度条件。
程序的思想是先调用<code>readbuff()</code>尝试读取字符串，如果读到81个有效字符而没有遇到EOF或是’\n’时，继续调用<code>copyline()</code>
来输出之前保存在buffer[]中的字符以及剩余的字符。</p>

<p>还需要注意的是<code>readbuff()</code>和<code>copyline()</code>对<code>size_t</code>类型的<code>i</code>变量进行初始化。试想<code>readbuff()</code>不对<code>i</code>进行初始化，
<code>i</code>的初始值是未知的，假设是一个很大的数，将会直接跳过<code>while</code>语句返回1，然后使<code>main()</code>调用<code>copyline()</code>把所有字符
都输出，造成错误。所以初始化赋值往往对程序的正确性有很大的影响，一个小的扰动也能造成程序发生重大错误。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cp">#define MINLENGTH 81</span>

<span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">MINLENGTH</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">readbuff</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">copyline</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">status</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">readbuff</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">copyline</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">readbuff</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	
	<span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">MINLENGTH</span><span class="p">){</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">copyline</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">size_t</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	
	<span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">MINLENGTH</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="n">putchar</span><span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
	<span class="k">while</span><span class="p">(</span><span class="n">status</span> <span class="o">==</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
		<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">)</span>
			<span class="n">status</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
			<span class="n">status</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p>Exercise 1-18. Write a program to remove trailing blanks and tabs from each line of input,
and to delete entirely blank lines.</p>
</blockquote>

<p>下面是Ben Pfaff给出的解答，确实比较neat，理解程序有几个难点。
符号常量<code>MAXQUEUE</code>用来限制每次最大可处理的行末空白符号(‘\t’或’ ‘)数量，如程序中设定为1001，则表示
最大每次可以处理行末出现1000个空白符号，空白符号临时存储在<code>blank[]</code>数组中，<code>head</code>用来标识最后
存在<code>blank[]</code>中的空白符号位置，<code>tail</code>用来标识当前未处理的第一个空白符号的位置。Ben Pfaff的意思
是既然到目前章节为止还没有介绍动态分配存储空间的技术，那么限定每次可以处理的空白符号数量，如果
某次没有处理完，那么通过<code>main()</code>函数的返回值<code>retval</code>来指示给系统程序还需要继续处理，这样就可以通过系统
程序多次调用该处理程序来达到目的。</p>

<p>如果读入换行符，表示这一行已经到了输入结尾，需要将<code>head</code>和<code>tail</code>初始化，然后根据<code>nonspace</code>来
判断是否还有空白字符没有处理，如果<code>nonspace</code>是0，则这就是一个只包含换行符或是只包含空白字符和
换行符的行，直接删除掉(即不输出换行符)，如果<code>nonspace</code>是1，则表示空白字符已经处理完或是已经处理
完了这次系统调用能处理的行末空白字符(之后说明)。若遇到空白符号，首先检查当前<code>blank[]</code>中已经临时存放了多少
待处理的空白字符，若是没有达到上限，则将空白字符存在<code>head</code>位置同时<code>head</code>要往后移一个单位。若是
已经达到上限，此时无论当前存储的空白字符是否属于行末空白符，都要先输出一个空白符，如果这个被输
出的空白字符不属于行末空白字符，当然不影响，但如果这个被输出的空白字符属于行末字符，则为了保证
之后的空白字符正确存储进<code>blank[]</code>，必须要腾出位置来，这个输出的行末空白字符要留给下一次系统程序
调用时再来处理。输出<code>tail</code>位置的空白字符，<code>tail</code>相应地要往<code>head</code>靠近一个单位，并修改<code>retval</code>告诉
系统程序这次调用没有处理好，同时要将<code>nonspace</code>置1，因为这次系统调用已经处理不了了，遇到’\n’时
只能输出换行符，把未处理完的任务”留给后人解决”。腾出位置后将最新读入的空白字符存到<code>head</code>位置处
然后往后移一个单位。若遇到非空白字符，则输出<code>blank[]</code>之中临时存储的所有空白字符，然后输出非空白
字符并将<code>nonspace</code>置1表示<code>blank[]</code>中没有还未输出的空白字符。</p>

<p>由于在命令行直接输出不便验证是否去除了行末空白字符，使用<strong>输出重定向</strong>到文件来验证是一种检查正确性
的方法。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>

<span class="cp">#define MAXQUEUE 1001</span>

<span class="kt">int</span> <span class="nf">advance</span><span class="p">(</span><span class="kt">int</span> <span class="n">pointer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pointer</span> <span class="o">&lt;</span> <span class="n">MAXQUEUE</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">pointer</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="c1">//freopen(&quot;output.txt&quot;,&quot;w&quot;,stdout);   /*输出重定向到文件*/</span>
	<span class="kt">char</span> <span class="n">blank</span><span class="p">[</span><span class="n">MAXQUEUE</span><span class="p">];</span>	
	<span class="kt">int</span> <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">;</span>	
	<span class="kt">int</span> <span class="n">nonspace</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">retval</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
	
	<span class="n">retval</span> <span class="o">=</span> <span class="n">nonspace</span> <span class="o">=</span> <span class="n">head</span> <span class="o">=</span> <span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">head</span> <span class="o">=</span> <span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">nonspace</span><span class="p">)</span>	
				<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
			<span class="n">nonspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\t&#39;</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">advance</span><span class="p">(</span><span class="n">head</span><span class="p">)</span> <span class="o">==</span> <span class="n">tail</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">putchar</span><span class="p">(</span><span class="n">blank</span><span class="p">[</span><span class="n">tail</span><span class="p">]);</span>
				<span class="n">tail</span> <span class="o">=</span> <span class="n">advance</span><span class="p">(</span><span class="n">tail</span><span class="p">);</span>
				<span class="n">nonspace</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">blank</span><span class="p">[</span><span class="n">head</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
			<span class="n">head</span> <span class="o">=</span> <span class="n">advance</span><span class="p">(</span><span class="n">head</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="k">while</span> <span class="p">(</span><span class="n">head</span> <span class="o">!=</span> <span class="n">tail</span><span class="p">)</span> <span class="p">{</span>	
				<span class="n">putchar</span><span class="p">(</span><span class="n">blank</span><span class="p">[</span><span class="n">tail</span><span class="p">]);</span>
				<span class="n">tail</span> <span class="o">=</span> <span class="n">advance</span><span class="p">(</span><span class="n">tail</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>		
			<span class="n">nonspace</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>细心的同学会发现上面的程序经过多次系统调用总能处理完行末空白符号，但是如果两个非空白字符之间的空白字符达到了处理上限(例如：”A”
+1000个空白字符+”B”)，虽然
这些空白字符都能正确输出并且不影响处理可能会出现的行末空白符，但是<code>retval</code>同样会给系统程序返回还要继续处理的信号，这样就会
造成系统程序在处理这种扰动情况时虽然已经处理好了仍然会无限次地调用该程序。查看系统程序调用后的返回值可以使用命令<code>echo $?</code>来查看
，我们可以将<code>MAXQUEUE</code>修改得较小来验证。Chris Sidi给出了基于Ben Pfaff给出的方法的改进的方法，
加入新变量<code>spaceJustPrinted</code>来检查当前最后输出的字符是否为空白字符，这样在遇到换行符时再根据之前输出的字符来判断是否要返回错误
信号。程序还增加了处理某些文本文件最后一行没有换行符的情况，增加了鲁棒性。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>

<span class="cp">#define MAXQUEUE 1001</span>

<span class="kt">int</span> <span class="nf">advance</span><span class="p">(</span><span class="kt">int</span> <span class="n">pointer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pointer</span> <span class="o">&lt;</span> <span class="n">MAXQUEUE</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">pointer</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  	<span class="k">else</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">blank</span><span class="p">[</span><span class="n">MAXQUEUE</span><span class="p">];</span>
 	<span class="kt">int</span> <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">;</span>
  	<span class="kt">int</span> <span class="n">nonspace</span><span class="p">;</span>
  	<span class="kt">int</span> <span class="n">retval</span><span class="p">;</span>
  	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
  	<span class="kt">int</span> <span class="n">spaceJustPrinted</span><span class="p">;</span> <span class="cm">/*boolean: was the last character printed whitespace?*/</span>

	<span class="n">retval</span> <span class="o">=</span> <span class="n">spaceJustPrinted</span> <span class="o">=</span> <span class="n">nonspace</span> <span class="o">=</span> <span class="n">head</span> <span class="o">=</span> <span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  	<span class="k">while</span> <span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">head</span> <span class="o">=</span> <span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      	    <span class="k">if</span> <span class="p">(</span><span class="n">spaceJustPrinted</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="cm">/*if some trailing whitespace was printed...*/</span>
        		<span class="n">retval</span> <span class="o">=</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
      	    <span class="k">if</span> <span class="p">(</span><span class="n">nonspace</span><span class="p">)</span> <span class="p">{</span>
        		<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
        		<span class="n">spaceJustPrinted</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* this instruction isn&#39;t really necessary since</span>
<span class="cm">                                        spaceJustPrinted is only used to determine the</span>
<span class="cm">                                        return value, but we&#39;ll keep this boolean</span>
<span class="cm">                                        truthful */</span>
       		    <span class="n">nonspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="cm">/* moved inside conditional just to save a needless</span>
<span class="cm">                                assignment */</span>
      	    <span class="p">}</span>
    	<span class="p">}</span>
    	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\t&#39;</span><span class="p">)</span> <span class="p">{</span>
      	    <span class="k">if</span> <span class="p">(</span><span class="n">advance</span><span class="p">(</span><span class="n">head</span><span class="p">)</span> <span class="o">==</span> <span class="n">tail</span><span class="p">)</span> <span class="p">{</span>
        		<span class="n">putchar</span><span class="p">(</span><span class="n">blank</span><span class="p">[</span><span class="n">tail</span><span class="p">]);</span> <span class="cm">/* these whitespace chars being printed early</span>
<span class="cm">                                      are only a problem if they are trailing,</span>
<span class="cm">                                      which we&#39;ll check when we hit a \n or EOF */</span>
        		<span class="n">spaceJustPrinted</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        		<span class="n">tail</span> <span class="o">=</span> <span class="n">advance</span><span class="p">(</span><span class="n">tail</span><span class="p">);</span>
        		<span class="n">nonspace</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
     	 	<span class="p">}</span>
    		<span class="n">blank</span><span class="p">[</span><span class="n">head</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
      	    <span class="n">head</span> <span class="o">=</span> <span class="n">advance</span><span class="p">(</span><span class="n">head</span><span class="p">);</span>
    	<span class="p">}</span>
    	<span class="k">else</span> <span class="p">{</span>
      	    <span class="k">while</span> <span class="p">(</span><span class="n">head</span> <span class="o">!=</span> <span class="n">tail</span><span class="p">)</span> <span class="p">{</span>
        		<span class="n">putchar</span><span class="p">(</span><span class="n">blank</span><span class="p">[</span><span class="n">tail</span><span class="p">]);</span>
        		<span class="n">tail</span> <span class="o">=</span> <span class="n">advance</span><span class="p">(</span><span class="n">tail</span><span class="p">);</span>
      	    <span class="p">}</span>
      	<span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
      	<span class="n">spaceJustPrinted</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      	<span class="n">nonspace</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    	<span class="p">}</span>
  	<span class="p">}</span>

  	<span class="cm">/* if the last line wasn&#39;t ended with a newline before the EOF,</span>
<span class="cm">  	we&#39;ll need to figure out if trailing space was printed here */</span>
  	<span class="k">if</span> <span class="p">(</span><span class="n">spaceJustPrinted</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="cm">/*if some trailing whitespace was printed...*/</span> 
    	<span class="n">retval</span> <span class="o">=</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>

 	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>这道题还有其他的方法，比如将输入存到字符数组，然后从换行符开始往前删可能的空白字符等。</p>

<blockquote>
  <p>Exercise 1-19. Write a function <code>reverse(s)</code> that reverses the character string <code>s</code>. Use it to
write a program that reverses its input a line at a time.</p>
</blockquote>

<p>一种简单的思路是把行末换行符先去掉，然后将’\0’之前的字符颠倒顺序，最后输出的时候再补上换行符。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cp">#define MAX_LINE 1024</span>

<span class="kt">void</span> <span class="nf">discardnewline</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[]);</span>
<span class="kt">int</span> <span class="nf">reverse</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[]);</span>
<span class="kt">int</span> <span class="nf">getaline</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[],</span><span class="kt">int</span> <span class="n">lim</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">line</span><span class="p">[</span><span class="n">MAX_LINE</span><span class="p">];</span>

	<span class="k">while</span><span class="p">(</span><span class="n">getaline</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">MAX_LINE</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">discardnewline</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
		<span class="n">reverse</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">line</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">discardnewline</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
			<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">reverse</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>

	<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">;</span>
	<span class="o">--</span><span class="n">j</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">ch</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
		<span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">;</span>
		<span class="o">--</span><span class="n">j</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">getaline</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">lim</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span><span class="n">i</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="n">i</span> <span class="o">&lt;</span> <span class="n">lim</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
		<span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span><span class="sc">&#39;\n&#39;</span><span class="p">){</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>看上去行末的’\n’确实比较讨厌，所以要先把它去掉，但是仔细想想，其实这并不是必要的，可以精简
程序如下。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cp">#define MAX_LINE 1024</span>

<span class="kt">int</span> <span class="nf">reverse</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[]);</span>
<span class="kt">int</span> <span class="nf">getaline</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[],</span><span class="kt">int</span> <span class="n">lim</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">line</span><span class="p">[</span><span class="n">MAX_LINE</span><span class="p">];</span>

	<span class="k">while</span><span class="p">(</span><span class="n">getaline</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">MAX_LINE</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">reverse</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="n">line</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">reverse</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>

	<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">;</span>
	<span class="o">--</span><span class="n">j</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">ch</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
		<span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">;</span>
		<span class="o">--</span><span class="n">j</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">getaline</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">lim</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span><span class="n">i</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="n">i</span> <span class="o">&lt;</span> <span class="n">lim</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
		<span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span><span class="sc">&#39;\n&#39;</span><span class="p">){</span>
		<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<h1 id="section-12">外部变量与作用域</h1>

<p>在<code>main()</code>中声明的变量例如<code>line</code>,<code>longest</code>等对于<code>main()</code>是<strong>局部(local)变量</strong>，其他函数不能直接访问。对于其他函数也是
一样，不同函数中的<code>i</code>并不具有联系。函数内的局部变量只在函数调用时创建，然后在函数退出时在内存中消失，因为这个原因常称
他们为<strong>自动(automatic)变量</strong>。自动变量不会在两次调用之间保存值，所以必须在函数入口处显式地设定。</p>

<p>除了自动变量，还可以定义一种<strong>外部(external)</strong>变量，能够被任何函数访问，这样可以替代参数列表来进行函数之间的通讯。这样
每次调用函数修改外部变量后其值都会保存。外部变量只能在所有函数之外定义一次，并分配存储空间。在函数中同时必须对其进行声
明后才能访问。可以通过<code>extern</code>语句显式声明，或通过上下文隐式声明。</p>

<p>为了说明外部变量，修改最长行程序如下，<code>max</code>为外部变量。</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cp">#define MAXLINE 1000	</span><span class="cm">/*  maximum input line size */</span><span class="cp"></span>

<span class="kt">int</span> <span class="n">max</span><span class="p">;</span>	<span class="cm">/* maximum length seen so far */</span>
<span class="kt">char</span> <span class="n">line</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span>		<span class="cm">/* current input line */</span>
<span class="kt">char</span> <span class="n">longest</span><span class="p">[</span><span class="n">MAXLINE</span><span class="p">];</span>	<span class="cm">/* longest line saved here */</span>

<span class="kt">int</span> <span class="nf">getaline</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">copy</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/*print longest input line; specialized version */</span>
<span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">len</span><span class="p">;</span>
	<span class="k">extern</span> <span class="kt">int</span> <span class="n">max</span><span class="p">;</span>
	<span class="k">extern</span> <span class="kt">char</span> <span class="n">longest</span><span class="p">[];</span>

	<span class="n">max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">getaline</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">if</span><span class="p">(</span><span class="n">len</span> <span class="o">&gt;</span> <span class="n">max</span><span class="p">){</span>
			<span class="n">max</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
			<span class="n">copy</span><span class="p">();</span>
		<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">max</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>	<span class="cm">/* there was a line */</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="n">longest</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>		
<span class="p">}</span>

<span class="cm">/* getaline: specialized version */</span>
<span class="kt">int</span> <span class="n">getaline</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">c</span><span class="p">,</span><span class="n">i</span><span class="p">;</span>
	<span class="k">extern</span> <span class="kt">char</span> <span class="n">line</span><span class="p">[];</span>

	<span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAXLINE</span> <span class="o">-</span> <span class="mi">1</span>
		<span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">){</span>
		<span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* copy: specialized version */</span>
<span class="kt">void</span> <span class="n">copy</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">extern</span> <span class="kt">char</span> <span class="n">line</span><span class="p">[],</span><span class="n">longest</span><span class="p">[];</span>

	<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">((</span><span class="n">longest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span>
		<span class="o">++</span><span class="n">i</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>在函数使用外部变量之前，函数必须要知道外部变量的名字，声明前面要加上关键字<code>extern</code>。在特定情况下，<code>extern</code>可以省略，这时
外部变量需要在函数之前定义，这样<code>main()</code>,<code>getaline()</code>,<code>copy()</code>中的<code>extern</code>都是多余的。</p>

<blockquote>
  <p>In fact, common practice is to place definitions of all external
variables at the beginning of the source file, and then omit all extern declarations.</p>
</blockquote>

<p>另外一种情况，如果程序有多个源文件，一个变量定义在_file1_中并且在_file2_和_file3_中使用，在_file2_和_file3_中必须用<code>extern</code>
声明。通常实践上将外部变量和函数放在一个文件中，即头文件。</p>

<p>因为上面的<code>getaline()</code>和<code>copy()</code>没有参数，但是为了向前兼容，ANSI C使用<code>void</code>来显式声明，以关闭所有参数列表检查。</p>

<p>需要注意<strong>定义(definitions)</strong>和<strong>声明(declarations)</strong>的区别，定义是创建变量并分配存储空间，声明是说明变量性质但不分配内存。</p>

<blockquote>
  <p>The usual practice is to collect extern declarations of variables and functions in a
separate file, historically called a header, that is included by #include at the front of each
source file.</p>
</blockquote>

<p>另外，过分依赖外部变量实际上并不好(虽然看起来这样可以简化通讯，参数列表可以变短并且变量访问更容易)。</p>

<blockquote>
  <p>But external variables are always there even when you don’t want them.
Relying too heavily on external variables is fraught with peril since it leads to programs
whose data connections are not all obvious - variables can be changed in unexpected and even
inadvertent ways, and the program is hard to modify.</p>
</blockquote>

<p>这一节的最长行版本并没有之前的版本好，有两个原因：</p>

<ul>
  <li>过度依赖外部变量；</li>
  <li>把程序里的变量放到函数模块中，这样破坏了<code>getaline()</code>和<code>copy()</code>的通用性。</li>
</ul>

<blockquote>
  <p>Exercise 1-20. Write a program <strong>detab</strong> that replaces tabs in the input with the proper number
of blanks to space to the next tab stop. Assume a fixed set of tab stops, say every n columns.
Should n be a variable or a symbolic parameter?</p>
</blockquote>

<blockquote>
  <p>Exercise 1-21. Write a program entab that replaces strings of blanks by the minimum
number of tabs and blanks to achieve the same spacing. Use the same tab stops as for detab.
When either a tab or a single blank would suffice to reach a tab stop, which should be given
preference?</p>
</blockquote>

<blockquote>
  <p>Exercise 1-22. Write a program to ``fold’’ long input lines into two or more shorter lines after
the last non-blank character that occurs before the n-th column of input. Make sure your
program does something intelligent with very long lines, and if there are no blanks or tabs
before the specified column.</p>
</blockquote>

<blockquote>
  <p>Exercise 1-23. Write a program to remove all comments from a C program. Don’t forget to
handle quoted strings and character constants properly. <strong>C comments don’t nest</strong>.</p>
</blockquote>

<blockquote>
  <p>Exercise 1-24. Write a program to check a C program for rudimentary syntax errors like
unmatched parentheses, brackets and braces. Don’t forget about quotes, both single and
double, escape sequences, and comments. (This program is hard if you do it in full
generality.)</p>
</blockquote>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-04-03T00:00:00+08:00"><a href="http://localhost:4000/blog/relearning-c-in-a-comprehensive-way/">April 03, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About OnceMore">OnceMore</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/blog/relearning-c-in-a-comprehensive-way/" rel="bookmark" title="Relearning C in a comprehensive way" itemprop="url">Relearning C in a comprehensive way</a></h1>
    
  </header>
  <div class="entry-content">
    <p>这是一系列关于C语言学习的笔记，题目的意思是“重新修炼C语言”，从了解到使用C语言已经快3年了，但是之前学得真是马马虎
虎，恰好最近闲下来，觉得有必要重新学习和理解一下C语言。</p>

<h1 class="no_toc" id="section">目录</h1>

<ul id="markdown-toc">
  <li><a href="#section-1">学习参考</a></li>
  <li><a href="#section-2">学习路线</a></li>
  <li><a href="#section-3">基本语法</a></li>
  <li><a href="#section-4">操作系统接口</a></li>
  <li><a href="#section-5">数据结构与算法分析</a></li>
</ul>

<h1 id="section-1">学习参考</h1>
<p>这个过程中打算参考的书籍，笔记，博文等主要如下。重新修炼的这个过程是有一个周期的，所以这个列表会随着
时间的推移而动态更新：</p>

<ul>
  <li><em>The C Programming Language(2nd Edition), Brian Kernighan and Dennis Ritchie</em> (<strong>K&amp;R</strong>)</li>
  <li><a href="http://users.powernet.co.uk/eton/kandr2/index.html"><em>Answers to Exercises in K&amp;R</em></a></li>
  <li><a href="http://coolshell.cn/articles/4102.html"><em>如何学好C语言</em>, 陈皓</a></li>
  <li><a href="https://github.com/qyuhen/book"><em>C 学习笔记, Q.yuhen</em></a></li>
</ul>

<h1 id="section-2">学习路线</h1>

<ul>
  <li>基本语法</li>
  <li>操作系统接口</li>
  <li>数据结构与算法分析</li>
</ul>

<h1 id="section-3">基本语法</h1>

<p>基本语法部分以<strong>K&amp;R</strong>为主线进行学习。特色是记录原书中的要点并附上每一道习题的解答。所有的程序都在机器上成功运行过。</p>

<p><a href="http://oncemore2020.github.io/knr-chap1/" class="btn btn-info">K&amp;R-Chapter1</a></p>

<h1 id="section-4">操作系统接口</h1>

<h1 id="section-5">数据结构与算法分析</h1>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-03-31T00:00:00+08:00"><a href="http://localhost:4000/blog/markdownxue-xi-bi-ji/">March 31, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About OnceMore">OnceMore</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~8 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/blog/markdownxue-xi-bi-ji/" rel="bookmark" title="Markdown学习笔记" itemprop="url">Markdown学习笔记</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Markdown是一种<a href="http://zh.wikipedia.org/wiki/%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80"><strong>轻量级标记语言</strong></a>，由<a href="http://en.wikipedia.org/wiki/John_Gruber"><strong>John Gruber</strong></a>和
<a href="http://en.wikipedia.org/wiki/Aaron_Swartz"><strong>Aaron Swartz</strong></a>创始。我之前使用过MS Office类文本处理器和TeX排版系统(算是两个派系)，
了解过Markdown后我认为他在前两者之间取了一个折中，即同时保留了<strong>易读性</strong>和<strong>易写性</strong>,所以有必要进行系统地学习。本文特色是和LaTeX
进行了对比分析。</p>

<h1 class="no_toc" id="section">文章目录</h1>

<ul id="markdown-toc">
  <li><a href="#section-1">编辑器</a></li>
  <li><a href="#start">入门-基本语法</a>    <ul>
      <li><a href="#section-2">段落</a></li>
      <li><a href="#section-3">转义字符</a></li>
      <li><a href="#section-4">标题</a></li>
      <li><a href="#section-13">引用</a></li>
      <li><a href="#section-14">列表</a></li>
      <li><a href="#section-15">分隔线</a></li>
      <li><a href="#section-16">代码块</a></li>
      <li><a href="#section-17">强调</a></li>
      <li><a href="#section-18">链接</a></li>
      <li><a href="#section-19">图片</a></li>
      <li><a href="#section-20">表格</a></li>
      <li><a href="#section-21">脚注</a></li>
    </ul>
  </li>
  <li><a href="#section-22">进阶-跨界合作</a>    <ul>
      <li><a href="#pygments">代码语法高亮-Pygments</a></li>
      <li><a href="#font-awesome">图标使用-Font Awesome</a></li>
      <li><a href="#section-23">文章内交叉引用</a></li>
      <li><a href="#section-24">自动生成目录</a></li>
      <li><a href="#mathjax">数学环境-Mathjax</a></li>
    </ul>
  </li>
  <li><a href="#section-25">总结</a></li>
</ul>

<h1 id="section-1">编辑器</h1>
<p>推荐使用在线Markdown编辑器<a href="https://stackedit.io/"><strong>StackEdit</strong></a>，能够实现实时的预览，首先这是基于Web的，不依赖操作
系统，这足以使许多人不必为如何使用Markdown而望而生畏，对于学习和验证语法是很好的。写博客时还是
推荐采用自己熟悉的文本编辑器提高效率，许多静态博客工具(比如此博客采用的<a href="http://jekyllrb.com/"><strong>Jekyll</strong></a>)会自动地生成相应的html网页。</p>

<h1 id="start">入门-基本语法</h1>

<h2 id="section-2">段落</h2>
<p>一个段落是不包含空行的文本片段，当出现一个空行时，表示空行下面的是新段落。在区块对象之间使用空行一般是比较好的习惯。
在LaTeX下面，使用<code>\\</code>和<code>\newline</code>或是一个空行进行换行，使用两个空行进行段落区分。</p>

<h2 id="section-3">转义字符</h2>
<p>接下来会介绍一些Markdown语法中的关键字(标号)，如何在文章中显示这些标号，而不是让Markdown处理
对应的关键字呢？方法和C的转义字符类似。使用反斜杠<code>\</code>后面加标号来实现，主要包括下面这些标号。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">\   反斜线
`   反引号
*   星号
_   底线
{}  花括号
[]  方括号
<span class="p">()</span>  括弧
#   井字号
<span class="p">+</span>   加号
<span class="p">-</span>   减号
.   英文句点
<span class="p">!</span>   惊叹号</code></pre></div>

<p>而在LaTeX中，基本上所有的关键字都会以<code>\</code>号开始，这和转义字符思想是一样的。</p>

<h2 id="section-4">标题</h2>
<p>Markdown采用<code>#</code>符号进行标题分级(类Atx形式)，最高可分级到六级标题。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">#一级标题

##二级标题

###三级标题

####四级标题

#####五级标题

######六级标题</code></pre></div>

<hr />

<h1 class="no_toc" id="section-5">一级标题</h1>

<h2 class="no_toc" id="section-6">二级标题</h2>

<h3 class="no_toc" id="section-7">三级标题</h3>

<h4 class="no_toc" id="section-8">四级标题</h4>

<h5 class="no_toc" id="section-9">五级标题</h5>

<h6 class="no_toc" id="section-10">六级标题</h6>

<hr />

<p>为了增强可读性，可在标题后面增加任意数量的<code>#</code>，但是标题分级由前面的<code>#</code>数量决定。</p>

<p>另外一种方法是类Setext形式，用<code>=</code>表示一级标题，<code>-</code>表示二级标题。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">一级标题
<span class="p">========</span>

二级标题
<span class="p">--------</span></code></pre></div>

<hr />

<h1 class="no_toc" id="section-11">一级标题</h1>

<h2 class="no_toc" id="section-12">二级标题</h2>

<hr />

<p>注意<code>=</code>和<code>-</code>的数量是任意的，一般的习惯是写到与标题长度对齐。
如果采用LaTeX呢，能想到的是用<code>\section{}</code>来实现对文章分节从而实现类似的效果。</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="k">\section</span><span class="nb">{</span>一级标题<span class="nb">}</span>
<span class="k">\subsection</span><span class="nb">{</span>二级标题<span class="nb">}</span>
<span class="k">\subsubsection</span><span class="nb">{</span>三级标题<span class="nb">}</span></code></pre></div>

<p>相比之下就会发现，使用Markdown来实现不需要章节自动编号的文章要简单得多，但是在文章需要有清晰的章节结构和自动编号的时候，
采用LaTeX仍然具有核心优势，特别是章节之间引用功能，是Markdown无法取代的。但这也正是Markdown的设计思想，轻量级。当然也有
跨界作品进行Markdown和LaTeX的整合，但已经暂时超出了Markdown基本语法的学习范围。</p>

<h2 id="section-13">引用</h2>
<p>Markdown采用<code>&gt;</code>符号进行标记引用的内容，引用允许采用嵌套，这时只需要采用<code>&gt;&gt;</code>即可，<code>&gt;</code>的数量表示
嵌套的层次。同时，引用内允许采用其他markdown语法。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">&gt;</span> 张三丰道
<span class="p">&gt;</span>
<span class="p">&gt;&gt;</span> 用意不用力，太极圆转，无使断绝。
<span class="p">&gt;</span>
<span class="p">&gt;</span> 当得机得势，令对手其根自断。一招一式，务须节节贯串，如长江大河，滔滔不绝。
<span class="p">&gt;</span> 他适才见张无忌临敌使招，已颇得太极三昧，只是他原来武功太强，拳招中棱角分
<span class="p">&gt;</span> 明，未能体会太极拳那“圆转不断”之意。</code></pre></div>

<hr />

<blockquote>
  <p>张三丰道</p>

  <blockquote>
    <p>用意不用力，太极圆转，无使断绝。</p>
  </blockquote>

  <p>当得机得势，令对手其根自断。一招一式，务须节节贯串，如长江大河，滔滔不绝。
他适才见张无忌临敌使招，已颇得太极三昧，只是他原来武功太强，拳招中棱角分
明，未能体会太极拳那“圆转不断”之意。</p>
</blockquote>

<hr />

<p>在LaTeX中，需要使用摘录环境：<code>quote</code>,<code>quotation</code>或是<code>verse</code>。</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="k">\begin</span><span class="nb">{</span>quote<span class="nb">}</span>
引文两端都缩进。
<span class="k">\end</span><span class="nb">{</span>quote<span class="nb">}</span>

<span class="k">\begin</span><span class="nb">{</span>quotation<span class="nb">}</span>
引文两端都缩进，首行增加缩进。
<span class="k">\end</span><span class="nb">{</span>quotation<span class="nb">}</span>

<span class="k">\begin</span><span class="nb">{</span>verse<span class="nb">}</span>
引文两端缩进，第二行起增加缩进。
<span class="k">\end</span><span class="nb">{</span>verse<span class="nb">}</span></code></pre></div>

<p>相比之下，在对引文格式没有严格要求的情况下，使用Markdown较为方便，但是对引文格式有严格要求的场合，LaTeX
仍然是最适合的，Markdown在这种场合之下需要手动设置各行的缩进，反而不如LaTeX方便。</p>

<h2 id="section-14">列表</h2>
<p>支持无序列表和有序列表。无序列表使用<code>*</code>,<code>+</code>,<code>-</code>号进行标记,他们的作用是等效的。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">* 苹果
<span class="p">+</span> 番茄
<span class="p">-</span> 板蓝根</code></pre></div>

<hr />

<ul>
  <li>苹果</li>
  <li>番茄</li>
  <li>板蓝根</li>
</ul>

<hr />

<p>有序列表需要使用数字标号。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="m">1</span>. 草莓
<span class="m">2</span>. 黄瓜
<span class="m">3</span>. 金银花</code></pre></div>

<hr />

<ol>
  <li>草莓</li>
  <li>黄瓜</li>
  <li>金银花</li>
</ol>

<hr />

<p>需要注意的是，在列表标号(<code>*</code>,<code>+</code>,<code>-</code>,<code>1.</code>)后面，需要有一个空格。另外，有序列表前面的数字标号实际上并不需要是正确的(也就是
想看起来的样子)，这完全是给懒人设计的，比如采用：</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="m">9</span>. 鬼
<span class="m">5</span>. 舞
<span class="m">2</span>. 日
<span class="m">7</span>. 决</code></pre></div>

<p>得到的是下面的效果：</p>

<hr />

<ol>
  <li>鬼</li>
  <li>舞</li>
  <li>日</li>
  <li>决</li>
</ol>

<hr />

<p>列表也支持较长的文本(段落)，这时只需要列表标号和段落起始之间要保留空格就好，段落换行
后的行缩进与否并不重要，但是保持整齐的缩进是比较好的风格。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">* 张无忌道：“人家高兴，你也高兴，那才是真高兴啊。”那少女
  冷笑道：“哼！我跟你说在前头，这时候我心里高兴，就不来害
  你。哪一天心中不高兴了，说不定会整治得你死不了，活不成，
  到时候你可别怪我。”
* 张无忌摇头到：“我从小给坏人整治到大，越是整治，越是硬朗。”
  那少女冷笑道：“别把话说得满了，咱们走着瞧吧。“</code></pre></div>

<hr />

<ul>
  <li>张无忌道：“人家高兴，你也高兴，那才是真高兴啊。”那少女
冷笑道：“哼！我跟你说在前头，这时候我心里高兴，就不来害
你。哪一天心中不高兴了，说不定会整治得你死不了，活不成，
到时候你可别怪我。”</li>
  <li>张无忌摇头到：“我从小给坏人整治到大，越是整治，越是硬朗。”
那少女冷笑道：“别把话说得满了，咱们走着瞧吧。“</li>
</ul>

<hr />

<p>如果一个列表项内包含多个段落，那么每个段落开头都必须缩进,不然会出现奇怪的格式错误，比如识别不出下一项列表项。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">* 张无忌道：“人家高兴，你也高兴，那才是真高兴啊。”
  
  那少女冷笑道：“哼！我跟你说在前头，这时候我心里高兴，就不来害
  你。哪一天心中不高兴了，说不定会整治得你死不了，活不成，
  到时候你可别怪我。”
* 张无忌摇头到：“我从小给坏人整治到大，越是整治，越是硬朗。”
  那少女冷笑道：“别把话说得满了，咱们走着瞧吧。“</code></pre></div>

<hr />

<ul>
  <li>
    <p>张无忌道：“人家高兴，你也高兴，那才是真高兴啊。”</p>

    <p>那少女冷笑道：“哼！我跟你说在前头，这时候我心里高兴，就不来害
你。哪一天心中不高兴了，说不定会整治得你死不了，活不成，
到时候你可别怪我。”</p>
  </li>
  <li>
    <p>张无忌摇头到：“我从小给坏人整治到大，越是整治，越是硬朗。”
那少女冷笑道：“别把话说得满了，咱们走着瞧吧。“</p>
  </li>
</ul>

<hr />

<p>如果需要在列表项里嵌入代码段或是引用段，需要注意引入额外的缩进以保持格式正确。</p>

<p>在LaTeX中，可以使用无序列表环境<code>itemize</code>，有序列表环境<code>enumerate</code>，描述列表
环境<code>description</code>以及<strong>paralist</strong>宏包提供的压缩列表环境<code>compactitem</code>，<code>compactenum</code>，
<code>compactdesc</code>以及行间列表环境<code>inparaitem</code>，<code>inparaenum</code>，<code>inparadesc</code>等多种环境。
在功能集合角度来说更加完备。同时，<code>\item</code>项后可以使用<code>[]</code>来设置不同的列表标记符号，
特别是和<strong>amssymb</strong>宏包配合起来的时候更加强大。例如：</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="k">\begin</span><span class="nb">{</span>itemize<span class="nb">}</span>
	<span class="k">\item</span><span class="na">[$\spadesuit$]</span> 令狐冲 
	<span class="k">\item</span><span class="na">[$\clubsuit$]</span>  任盈盈
<span class="k">\end</span><span class="nb">{</span>itemize<span class="nb">}</span></code></pre></div>

<p>能够得到这样的效果：
<img src="/images/markdownxuexibiji/latexlist.png" alt="latexlist" /></p>

<h2 id="section-15">分隔线</h2>
<p>在同一行中使用三个以上的<code>*</code>,<code>-</code>,<code>_</code>来建立一个分隔线，分隔线标号之间允许出现空格。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">***

<span class="p">---</span>

___

* * *</code></pre></div>

<p>在LaTeX中，采用<code>rule</code>来画分隔线，如<code>\noindent\rule{\textwidth}{1pt}</code>。</p>

<h2 id="section-16">代码块</h2>
<p>一小段语句或是表达式可以用<code>`</code>号括起来，注意如果代码片段内包含<code>`</code>符号，需要使用两个<code>`</code>括起来</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">A single backtick <span class="k">in</span> <span class="k">a</span> code span: `` ` ``

A backtick<span class="p">-</span>delimited string <span class="k">in</span> <span class="k">a</span> code span: `` `foo` ``</code></pre></div>

<hr />

<p>A single backtick in a code span: <code>`</code></p>

<p>A backtick-delimited string in a code span: <code>`foo`</code></p>

<hr />

<p>若是涉及到较长的多行代码片段，简单的代码块可以采用缩进来实现。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">下面是代码示例：

	#<span class="nb">include</span><span class="p">&lt;</span>stdio.<span class="k">h</span><span class="p">&gt;</span>
	int <span class="k">main</span><span class="p">(</span>void<span class="p">)</span>
	{
		printf<span class="p">(</span><span class="s2">&quot;旮那边的朋友你们好!\n&quot;</span><span class="p">)</span>;
		<span class="k">return</span> <span class="m">0</span>;
	}</code></pre></div>

<hr />

<p>下面是代码示例：</p>

<pre><code>	#include&lt;stdio.h&gt;
	int main(void)
	{
		printf("旮那边的朋友你们好!\n");
		return 0;
	}
</code></pre>

<hr />

<p>如果需要代码语法高亮功能，需要配合相应插件来使用，推荐使用<a href="http://pygments.org/"><strong>Pygments</strong></a>。
用下面的方法将代码段拷贝进<code>{% highlight # %}</code>和<code>{% endhighlight %}</code>
之间即可。<code>#</code>表示相应的编程语言，可以参考<a href="http://pygments.org/languages/">支持的语言</a>。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">{% <span class="nb">highlight</span> C %}
#<span class="nb">include</span><span class="p">&lt;</span>stdio.<span class="k">h</span><span class="p">&gt;</span>
int <span class="k">main</span><span class="p">(</span>void<span class="p">)</span>
{
	printf<span class="p">(</span><span class="s2">&quot;旮那边的朋友你们好!\n&quot;</span><span class="p">)</span>;
	<span class="k">return</span> <span class="m">0</span>;
}
{% endhighlight %}</code></pre></div>

<p>在LaTeX中，需要采用<strong>listings</strong>宏包，功能同样非常完备，下面是我喜欢的一种配置。</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="k">\usepackage</span><span class="nb">{</span>listings<span class="nb">}</span>
<span class="k">\lstset</span><span class="nb">{</span>numbers=left,numbersep=4pt,
frame=lines,framerule=1pt,basicstyle=<span class="k">\ttfamily\scriptsize</span>,
<span class="nb">}</span>

...

<span class="k">\begin</span><span class="nb">{</span>lstlisting<span class="nb">}</span>[language=bash]
find ./positive<span class="nb">_</span>images/ -name &#39;*.pgm&#39; -exec<span class="k">\ </span>
	echo <span class="k">\{\}</span> 1 0 0 18 36 <span class="k">\;</span> &gt;positives.txt
<span class="k">\end</span><span class="nb">{</span>lstlisting<span class="nb">}</span></code></pre></div>

<h2 id="section-17">强调</h2>
<p>Markdown使用<code>*</code>和<code>_</code>标号来强调，包围在两个<code>**</code>或是<code>__</code>之间的内容会显示成粗体，包围在两个<code>*</code>或是<code>_</code>之间的
内容会显示成斜体。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">**滚粗**

__滚粗__

*黄药师*

_郭襄_</code></pre></div>

<hr />

<p><strong>滚粗</strong></p>

<p><strong>滚粗</strong></p>

<p><em>黄药师</em></p>

<p><em>郭襄</em></p>

<hr />

<p>在LaTeX中，可以使用<code>underline</code>下划线强调，或是使用<code>emph</code>进行斜体强调，同时，可以使用
<code>textit</code>,<code>textsf</code>,<code>texttt</code>,<code>textbf</code>等来实现，功能比Markdown要完备。</p>

<h2 id="section-18">链接</h2>
<p>Markdown支持两种形式的链接标记，其一是行内式，链接文字用<code>[]</code>括起来，链接地址用<code>()</code>括起来。
<code>"Title"</code>可以省略。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">这是我的[主页]<span class="p">(</span>http:<span class="sr">//</span>oncemore2020.github.io <span class="s2">&quot;Title&quot;</span><span class="p">)</span>.</code></pre></div>

<hr />

<p>这是我的<a href="http://oncemore2020.github.io" title="Title">主页</a>.</p>

<hr />

<p>如果链接地址需要多次使用，每一次都输入地址难免过于麻烦，这时候适合采用参考式。
参考式可以把链接地址内容在文章的任何地方用一个标记来表示，然后在其它地方引用这个
标记。如下面这个例程，使用第一行的参考式时，<code>homepage</code>标号在第二行定义。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">这是我的[主页][homepage]。
[homepage]: http:<span class="sr">//</span>oncemore2020.github.io  <span class="s2">&quot;TEMPORA MUTANTUR NOS ET MUTAMUR IN ILLIS&quot;</span></code></pre></div>

<hr />

<p>这是我的<a href="http://oncemore2020.github.io" title="TEMPORA MUTANTUR NOS ET MUTAMUR IN ILLIS">主页</a>。</p>

<hr />

<p>也可以省略第二个<code>[]</code>里的标记，这时会默认把链接文字就当成是标号。下面提供两种比较好的范例。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">I <span class="k">get</span> <span class="m">10</span> times <span class="nb">more</span> traffic from [Google] [<span class="m">1</span>] than from
[Yahoo] [<span class="m">2</span>] or [MSN] [<span class="m">3</span>].

  [<span class="m">1</span>]: http:<span class="sr">//</span>google.<span class="k">com</span>/        <span class="s2">&quot;Google&quot;</span>
  [<span class="m">2</span>]: http:<span class="sr">//</span>search.yahoo.<span class="k">com</span>/  <span class="s2">&quot;Yahoo Search&quot;</span>
  [<span class="m">3</span>]: http:<span class="sr">//</span>search.msn.<span class="k">com</span>/    <span class="s2">&quot;MSN Search&quot;</span></code></pre></div>

<p>或是</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">I <span class="k">get</span> <span class="m">10</span> times <span class="nb">more</span> traffic from [Google][] than from
[Yahoo][] or [MSN][].

  [google]: http:<span class="sr">//</span>google.<span class="k">com</span>/        <span class="s2">&quot;Google&quot;</span>
  [yahoo]:  http:<span class="sr">//</span>search.yahoo.<span class="k">com</span>/  <span class="s2">&quot;Yahoo Search&quot;</span>
  [msn]:    http:<span class="sr">//</span>search.msn.<span class="k">com</span>/    <span class="s2">&quot;MSN Search&quot;</span></code></pre></div>

<p>都会产生下面的效果。</p>

<hr />

<p>I get 10 times more traffic from <a href="http://google.com/" title="Google">Google</a> than from
<a href="http://search.yahoo.com/" title="Yahoo Search">Yahoo</a> or <a href="http://search.msn.com/" title="MSN Search">MSN</a>.</p>

<hr />

<p>还有一种称为<strong>自动链接</strong>的方式，将地址直接放进<code>&lt;&gt;</code>中，支持网址和邮件地址。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">&lt;</span>address@example.<span class="k">com</span><span class="p">&gt;</span>

<span class="p">&lt;</span>http:<span class="sr">//</span>example.<span class="k">com</span>/<span class="p">&gt;</span></code></pre></div>

<hr />

<p><a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#097;&#100;&#100;&#114;&#101;&#115;&#115;&#064;&#101;&#120;&#097;&#109;&#112;&#108;&#101;&#046;&#099;&#111;&#109;">&#097;&#100;&#100;&#114;&#101;&#115;&#115;&#064;&#101;&#120;&#097;&#109;&#112;&#108;&#101;&#046;&#099;&#111;&#109;</a></p>

<p><a href="http://example.com/">http://example.com/</a></p>

<hr />

<p>在LaTeX中，使用<strong>hyperref</strong>宏包可以实现超链接和文章内的交叉引用，功能更加完备。
如交叉应用的实现。</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="k">\label</span><span class="nb">{</span>sec:hyperlink<span class="nb">}</span>

  ...

编号形式的链接：<span class="k">\ref</span><span class="nb">{</span>sec:hyperlink<span class="nb">}</span>
文字形式的链接：<span class="k">\hyperref</span><span class="na">[sec:hyperlink]</span><span class="nb">{</span>链接<span class="nb">}</span></code></pre></div>

<p>以及网址的链接实现：</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="k">\url</span><span class="nb">{</span>http://oncemore2020.github.io<span class="nb">}</span>
<span class="k">\href</span><span class="nb">{</span>http://oncemore2020.github.io<span class="nb">}{</span>王师的主页<span class="nb">}</span></code></pre></div>

<p>文章内没有清晰明了的交叉引用是Markdown的软肋。</p>

<h2 id="section-19">图片</h2>
<p>Markdown嵌入图片的方法和链接类似，也分为<strong>行内式</strong>和<strong>参考式</strong>。</p>

<p><strong>行内式</strong></p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">!</span>[Vim]<span class="p">(</span><span class="sr">/images/</span>markdownxuexibiji/<span class="k">vim</span>.png <span class="s2">&quot;vim logo&quot;</span><span class="p">)</span></code></pre></div>

<p>以及<strong>参考式</strong></p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">!</span>[Vim][id]

[id]: <span class="sr">/images/</span>markdownxuexibiji/<span class="k">vim</span>.png <span class="s2">&quot;vim logo&quot;</span></code></pre></div>

<p>都能嵌入如下的图片。</p>

<hr />

<p><img src="/images/markdownxuexibiji/vim.png" alt="Vim" title="vim logo" /></p>

<hr />

<p>图片地址可以采用网址或是本地路径。</p>

<p>Markdown的图片嵌入功能并不是很完善，比如不能较自由的控制图片大小位置以及对图片的引用和注释等等。相比之下，
LaTeX处理起图片相关的任务要成熟得多。常见的使用<code>figure</code>环境，如下面的IEEE Trans的规范插图方法。</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="c">%Single Column Floating Figure</span>
<span class="k">\begin</span><span class="nb">{</span>figure*<span class="nb">}</span>[!t]
<span class="k">\centering</span>
<span class="k">\includegraphics</span><span class="na">[width=5in]</span><span class="nb">{</span>myfigure.pdf<span class="nb">}</span>
<span class="k">\caption</span><span class="nb">{</span>Simulation Results.<span class="nb">}</span>
<span class="k">\label</span><span class="nb">{</span>fig<span class="nb">_</span>sim<span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>figure*<span class="nb">}</span>

<span class="c">%Double column floating figure</span>
<span class="k">\begin</span><span class="nb">{</span>figure*<span class="nb">}</span>[!t]
<span class="k">\centering</span>
<span class="k">\subfloat</span><span class="na">[Case I]</span><span class="nb">{</span><span class="k">\includegraphics</span><span class="na">[width=2.5in]</span><span class="nb">{</span>box<span class="nb">}</span><span class="c">%</span>
<span class="k">\label</span><span class="nb">{</span>fig<span class="nb">_</span>first<span class="nb">_</span>case<span class="nb">}}</span>
<span class="k">\hfil</span>
<span class="k">\subfloat</span><span class="na">[Case II]</span><span class="nb">{</span><span class="k">\includegraphics</span><span class="na">[width=2.5in]</span><span class="nb">{</span>box<span class="nb">}</span><span class="c">%</span>
<span class="k">\label</span><span class="nb">{</span>fig<span class="nb">_</span>second<span class="nb">_</span>case<span class="nb">}}</span>
<span class="k">\caption</span><span class="nb">{</span>Simulation results.<span class="nb">}</span>
<span class="k">\label</span><span class="nb">{</span>fig<span class="nb">_</span>sim<span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>figure*<span class="nb">}</span></code></pre></div>

<h2 id="section-20">表格</h2>
<p>Markdown采用下面的语法来实现表格。无对齐格式的方法：</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">Item      <span class="p">|</span> Value
<span class="p">---------</span> <span class="p">|</span> <span class="p">-----</span>
Computer  <span class="p">|</span> <span class="m">1600</span> USD
Phone     <span class="p">|</span> <span class="m">12</span> USD
Pipe      <span class="p">|</span> <span class="m">1</span> USD</code></pre></div>

<hr />

<table>
  <thead>
    <tr>
      <th>Item</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Computer</td>
      <td>1600 USD</td>
    </tr>
    <tr>
      <td>Phone</td>
      <td>12 USD</td>
    </tr>
    <tr>
      <td>Pipe</td>
      <td>1 USD</td>
    </tr>
  </tbody>
</table>

<hr />

<p>以及设置对齐的方法,<code>:</code>在若干数量的<code>-</code>左边表示左对齐，<code>:</code>在若干数量的<code>-</code>右边
表示右对齐，若干数量的<code>-</code>位于两个<code>:</code>中间表示中间对齐：</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">|</span> Item      <span class="p">|</span>    Value <span class="p">|</span> Qty  <span class="p">|</span>
<span class="p">|</span> :<span class="p">--------</span> <span class="p">|</span> <span class="p">--------</span>:<span class="p">|</span> :<span class="p">--</span>: <span class="p">|</span>
<span class="p">|</span> Computer  <span class="p">|</span> <span class="m">1600</span> USD <span class="p">|</span>  <span class="m">5</span>   <span class="p">|</span>
<span class="p">|</span> Phone     <span class="p">|</span>   <span class="m">12</span> USD <span class="p">|</span>  <span class="m">12</span>  <span class="p">|</span>
<span class="p">|</span> Pipe      <span class="p">|</span>    <span class="m">1</span> USD <span class="p">|</span> <span class="m">234</span>  <span class="p">|</span></code></pre></div>

<hr />

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: right">Value</th>
      <th style="text-align: center">Qty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Computer</td>
      <td style="text-align: right">1600 USD</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td style="text-align: left">Phone</td>
      <td style="text-align: right">12 USD</td>
      <td style="text-align: center">12</td>
    </tr>
    <tr>
      <td style="text-align: left">Pipe</td>
      <td style="text-align: right">1 USD</td>
      <td style="text-align: center">234</td>
    </tr>
  </tbody>
</table>

<hr />

<p>与插图环境类似，LaTeX在表格方面具有更完备的功能。下面是IEEE Trans的表格规范。</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="c">%Floating Table</span>
<span class="k">\begin</span><span class="nb">{</span>table<span class="nb">}</span>[!t]
<span class="k">\renewcommand</span><span class="nb">{</span><span class="k">\arraystretch</span><span class="nb">}{</span>1.3<span class="nb">}</span>
<span class="k">\caption</span><span class="nb">{</span>An Example of a Table<span class="nb">}</span>
<span class="k">\label</span><span class="nb">{</span>table<span class="nb">_</span>example<span class="nb">}</span>
<span class="k">\centering</span>
<span class="k">\begin</span><span class="nb">{</span>tabular<span class="nb">}{</span>|c||c|<span class="nb">}</span>
<span class="k">\hline</span>
One <span class="nb">&amp;</span> Two<span class="k">\\</span>
<span class="k">\hline</span>
Three <span class="nb">&amp;</span> Four<span class="k">\\</span>
<span class="k">\hline</span>
<span class="k">\end</span><span class="nb">{</span>tabular<span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>table<span class="nb">}</span></code></pre></div>

<h2 id="section-21">脚注</h2>
<p>Markdown使用下面的方法来设置脚注。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">You can create footnotes like this[^footnote].

  [^footnote]: Here <span class="k">is</span> the *text* of the **footnote**.</code></pre></div>

<hr />

<p>You can create footnotes like this<sup id="fnref:footnote"><a href="#fn:footnote" class="footnote">1</a></sup>.</p>

<hr />

<p>如果要实现和上面相同的脚注的话，LaTeX使用<code>footnote</code>来设置。</p>

<div class="highlight"><pre><code class="language-tex" data-lang="tex">You can create footnotes like this.<span class="k">\footnote</span><span class="nb">{</span>
Here is the <span class="k">\emph</span><span class="nb">{</span>text<span class="nb">}</span> of the <span class="k">\textbf</span><span class="nb">{</span>footnote<span class="nb">}</span>.<span class="nb">}</span></code></pre></div>

<h1 id="section-22">进阶-跨界合作</h1>
<p>由于Markdown和html的同源性(就像辟邪剑谱和葵花宝典一样)，使得以轻量级著称的Markdown可以插上许多翅膀从而在某些方面实现逆袭。</p>

<h2 id="pygments">代码语法高亮-Pygments</h2>
<p>这在入门部分的代码部分已经说明过。详细配置超出本文范围，可以参考其
<a href="http://pygments.org/" class="btn btn-info">官方网站</a>
配置过程非常简单。</p>

<h2 id="font-awesome">图标使用-Font Awesome</h2>

<p>使用<a href="http://fontawesome.io/"><strong>Font Awesome</strong></a>可以方便地使用美观的矢量图标，并且支持通过CSS自定义缩
放，色彩，阴影等。查看
<a href="http://fontawesome.io/get-started/" class="btn btn-info">Get Started with Font Awesome</a>
以了解配置方法。最简单的是使用<code>BootstrapCDN</code>方法，我采用的是<code>LESS Ruby Gem</code>方法，这样进行自定义时
相对来说比较方便，且不用担心速度的问题。配置好之后可以到
<a href="http://fontawesome.io/icons/" class="btn btn-info">icons</a>
查看可用的图标，找到图标对应的标识符之后，可采用如下的方法使用。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">&lt;</span><span class="k">i</span> class<span class="p">=</span><span class="s2">&quot;icon-file&quot;</span><span class="p">&gt;&lt;</span>/<span class="k">i</span><span class="p">&gt;</span></code></pre></div>

<p>其中<code>icon-file</code>为对应图标的标识符。下面的图标都是使用Font Awesome得到的。</p>

<p><i class="icon-compass icon-4x"></i>
<i class="icon-weibo icon-4x"></i>
<i class="icon-file-text icon-4x"></i>
<i class="icon-linux icon-4x"></i>
<i class="icon-youtube-play icon-4x"></i>
<i class="icon-anchor icon-4x"></i>
<i class="icon-cloud-download icon-4x"></i>
<i class="icon-comments icon-4x"></i>
<i class="icon-camera icon-4x"></i></p>

<p>更多使用方法，可以参考
<a href="http://fortawesome.github.io/Font-Awesome/examples/" class="btn btn-info">Examples</a>
了解更多。</p>

<p>由于LaTeX与html并不是很同源，所以要如此方便地使用图标功能，需要依赖于<code>METAFONT</code>和<code>METAPOST</code>，学习
曲线是比较陡峭的。</p>

<h2 id="section-23">文章内交叉引用</h2>
<p>需要注意的是交叉引用并不是标准Markdown的语法，一些转换器提供了这个扩展，比如本博客采用
的<a href="http://kramdown.gettalong.org/"><strong>kramdown</strong></a>。以<strong>kramdown</strong>为例，介绍交叉引用的方法。
首先需要在需要引用的分级标题后设置一个<code>{#id}</code>，然后在其它任何地方使用这个唯一的标识符来进行
引用以方便文章内的跳转。比如在本文源文件的<strong>入门-基本语法</strong>后面进行标识。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">#入门<span class="p">-</span>基本语法 {#<span class="k">start</span>}</code></pre></div>

<p>然后进行引用：</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">[入门<span class="p">-</span>基本语法]<span class="p">(</span>#<span class="k">start</span><span class="p">)</span></code></pre></div>

<p>点击下面的链接会跳转到相应的部分。</p>

<hr />

<p><a href="#start">入门-基本语法</a></p>

<hr />

<p>除了手动设置标题标识符之外，kramdown还支持自动生成各章节的标识符(这在默认的情况下是打开的)。
生成的规则如下：</p>

<ul>
  <li>删除除字母，数字，空格，横线以外的字符</li>
  <li>删除第一个字母之前的字符</li>
  <li>除了字母和数字外的字符被转换为横线</li>
  <li>所有字母转换为小写形式</li>
  <li>如果到了这一步所有字符都被删除了，使用<code>section</code>标识符</li>
  <li>如果标识符重复，则自动在后面加<code>-1</code>,<code>-2</code>来加以区分</li>
</ul>

<p>下面是标识符自动生成示例：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Sample header</th>
      <th style="text-align: left">generated ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"># This is a header</td>
      <td style="text-align: left">this-is-a-header</td>
    </tr>
    <tr>
      <td style="text-align: left">## 12. Anather one 1 here</td>
      <td style="text-align: left">another-one-1-here</td>
    </tr>
    <tr>
      <td style="text-align: left">### Do ^&amp; it now</td>
      <td style="text-align: left">do-it-now</td>
    </tr>
    <tr>
      <td style="text-align: left"># This is a header</td>
      <td style="text-align: left">this-is-a-header-1</td>
    </tr>
    <tr>
      <td style="text-align: left"># 123456789</td>
      <td style="text-align: left">section</td>
    </tr>
    <tr>
      <td style="text-align: left"># 金刚不坏之身</td>
      <td style="text-align: left">section-1</td>
    </tr>
  </tbody>
</table>

<p>kramdown的标识符生成算法没有考虑到中文支持，所以纯中文标题都会被编成<code>section</code>,并且会自动重命名加以区分。
比如本文中第一个标题是<code>编辑器</code>，则其对应的标识符为<code>section</code>,第二个标题是<code>入门-基本语法</code>，因为已经被手动
命名，所以其标识符就是手动命名的标识符，第三个标题是<code>段落</code>，则其标识符自动设置为<code>section-1</code>,依次类推。
这样的一个问题是需要引用的时候设置的标识符非常不清晰，所以在kramdown的标识符自动生成算法支持中文之前，
对需要引用的标题段手动设置标识符是比较好的方法。</p>

<p>如下将对<code>编辑器</code>段进行引用。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">[编辑器]<span class="p">(</span>#section<span class="p">)</span></code></pre></div>

<p>点击下面链接将跳转到对应部分。</p>

<hr />

<p><a href="#section">编辑器</a></p>

<hr />

<p>LaTeX的交叉引用功能前面已有介绍。</p>

<h2 id="section-24">自动生成目录</h2>
<p>了解了kramdown对章节的自动标识，再理解kramdown如何自动生成目录，就显而易见了。
因为kramdown自动对每一个章节标题设置标识符，则用这些标识符生成目录是很简单的。
kramdown规定<code>toc</code>为目录的引用名，将其放置在一个列表项目中会自动替换为当前文章
的目录结构。</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim"># 文章目录
{:.no_toc}

* 这段文字会被替换为文章目录，但目录内不包括 <span class="s2">&quot;文章目录&quot;</span> 自身
{:toc}</code></pre></div>

<p><code>{:.no_toc}</code>告诉kramdown不要将文章目录包含到自身之中，列表项中的文字都会被替换
成目录项，所以上面代码中的那些字并不会显示出来，只会显示目录本身。文章目录本身
的标识符则是<code>markdown-toc</code>。点击下面链接跳转到目录：</p>

<p><a href="#markdown-toc">文章目录</a></p>

<p>LaTeX的目录自动生成功能需要使用一条<code>\tableofcontents</code>来生成。</p>

<h2 id="mathjax">数学环境-Mathjax</h2>
<p>幸运的是kramdown内置了对LaTeX数学环境的支持，使用<strong>MathJax</strong>来渲染LaTeX数学表达式。但是并没有将MathJax合并
到kramdown中，要使用MathJax，需要在html的<code>script</code>段中添加如下代码，开启通过动态加载MathJax CDN来实现转换。</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span>
   <span class="na">src=</span><span class="s">&quot;http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></div>

<p>配置好MathJax以后，数学环境需要使用<code>$$</code>来包围，支持LaTeX ams宏包中的数学符号。
例如：</p>

<div class="highlight"><pre><code class="language-vim" data-lang="vim">$$
\begin{align*}
  &amp; \phi<span class="p">(</span><span class="k">x</span><span class="p">,</span><span class="k">y</span><span class="p">)</span> <span class="p">=</span> \phi \<span class="k">left</span><span class="p">(</span>\sum_{<span class="k">i</span><span class="p">=</span><span class="m">1</span>}^<span class="k">n</span> x_ie_i<span class="p">,</span> \sum_{<span class="k">j</span><span class="p">=</span><span class="m">1</span>}^<span class="k">n</span> y_je_j \<span class="k">right</span><span class="p">)</span>
  <span class="p">=</span> \sum_{<span class="k">i</span><span class="p">=</span><span class="m">1</span>}^<span class="k">n</span> \sum_{<span class="k">j</span><span class="p">=</span><span class="m">1</span>}^<span class="k">n</span> x_i y_j \phi<span class="p">(</span>e_i<span class="p">,</span> e_j<span class="p">)</span> <span class="p">=</span> \\
  &amp; <span class="p">(</span>x_1<span class="p">,</span> \ldots<span class="p">,</span> x_n<span class="p">)</span> \<span class="k">left</span><span class="p">(</span> \begin{array}{ccc}
      \phi<span class="p">(</span>e_1<span class="p">,</span> e_1<span class="p">)</span> &amp; \cdots &amp; \phi<span class="p">(</span>e_1<span class="p">,</span> e_n<span class="p">)</span> \\
      \vdots &amp; \ddots &amp; \vdots \\
      \phi<span class="p">(</span>e_n<span class="p">,</span> e_1<span class="p">)</span> &amp; \cdots &amp; \phi<span class="p">(</span>e_n<span class="p">,</span> e_n<span class="p">)</span>
    \<span class="k">end</span>{array} \<span class="k">right</span><span class="p">)</span>
  \<span class="k">left</span><span class="p">(</span> \begin{array}{<span class="k">c</span>}
      y_1 \\
      \vdots \\
      y_n
    \<span class="k">end</span>{array} \<span class="k">right</span><span class="p">)</span>
\<span class="k">end</span>{align*}
$$</code></pre></div>

<p>将得到如下数学环境：</p>

<hr />

<script type="math/tex; mode=display">% <![CDATA[

\begin{align*}
  & \phi(x,y) = \phi \left(\sum_{i=1}^n x_ie_i, \sum_{j=1}^n y_je_j \right)
  = \sum_{i=1}^n \sum_{j=1}^n x_i y_j \phi(e_i, e_j) = \\
  & (x_1, \ldots, x_n) \left( \begin{array}{ccc}
      \phi(e_1, e_1) & \cdots & \phi(e_1, e_n) \\
      \vdots & \ddots & \vdots \\
      \phi(e_n, e_1) & \cdots & \phi(e_n, e_n)
    \end{array} \right)
  \left( \begin{array}{c}
      y_1 \\
      \vdots \\
      y_n
    \end{array} \right)
\end{align*}
 %]]></script>

<hr />

<p>如果担心MathJax CDN的速度问题，可以查看
<a href="http://docs.mathjax.org/en/latest/installation.html" class="btn btn-info">Installing and Tesing MathJax</a>
将其配置到本地。事实上我采用从MathJax CDN转换速度并未受到明显影响。</p>

<p>由于数学环境本来就是从LaTeX中学习过来的，所以在这一点上并不需要进行比较。</p>

<h1 id="section-25">总结</h1>
<p>通过上面的对比分析，可以发现Markdown的易用性好且功能基本齐全，非常适合写作，写技术笔记，发表博客文章等应用场合。而在
科技论文和大型书籍排版方面，LaTeX显得更为成熟，并且Markdown中许多扩展特性的思想和LaTeX中实现的方法大体相同。所以对有
人说的Markdown配合扩展会在将来取代LaTeX的论断，我并不是很认可。相反，Markdown和LaTeX应该会在未来变得更加明确自己的任
务分工，并不断巩固自己的地位，这样才能健康地发展下去。作为用户并不希望看到将来”MarkTeX”的出现。</p>
<div class="footnotes">
  <ol>
    <li id="fn:footnote">
      <p>Here is the <em>text</em> of the <strong>footnote</strong>. <a href="#fnref:footnote" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    
      <a href="http://localhost:4000/blog/page2" class="btn">Previous</a>
    
  
  <ul class="inline-list">
    <li>
      
        <a href="http://localhost:4000/blog">1</a>
      
    </li>
    
      <li>
        
          <a href="http://localhost:4000/blog/page2">2</a>
        
      </li>
    
      <li>
        
          <span class="current-page">3</span>
        
      </li>
    
  </ul>
  
    Next
  
</div><!-- /.pagination -->

</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 OnceMore. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-49487364-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>


<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
          

</body>
</html>
